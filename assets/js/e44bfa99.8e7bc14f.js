"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[966],{3905:function(e,a,n){n.d(a,{Zo:function(){return u},kt:function(){return c}});var t=n(7294);function r(e,a,n){return a in e?Object.defineProperty(e,a,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[a]=n,e}function o(e,a){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);a&&(t=t.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),n.push.apply(n,t)}return n}function l(e){for(var a=1;a<arguments.length;a++){var n=null!=arguments[a]?arguments[a]:{};a%2?o(Object(n),!0).forEach((function(a){r(e,a,n[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))}))}return e}function i(e,a){if(null==e)return{};var n,t,r=function(e,a){if(null==e)return{};var n,t,r={},o=Object.keys(e);for(t=0;t<o.length;t++)n=o[t],a.indexOf(n)>=0||(r[n]=e[n]);return r}(e,a);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(t=0;t<o.length;t++)n=o[t],a.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=t.createContext({}),m=function(e){var a=t.useContext(s),n=a;return e&&(n="function"==typeof e?e(a):l(l({},a),e)),n},u=function(e){var a=m(e.components);return t.createElement(s.Provider,{value:a},e.children)},p={inlineCode:"code",wrapper:function(e){var a=e.children;return t.createElement(t.Fragment,{},a)}},d=t.forwardRef((function(e,a){var n=e.components,r=e.mdxType,o=e.originalType,s=e.parentName,u=i(e,["components","mdxType","originalType","parentName"]),d=m(n),c=r,k=d["".concat(s,".").concat(c)]||d[c]||p[c]||o;return n?t.createElement(k,l(l({ref:a},u),{},{components:n})):t.createElement(k,l({ref:a},u))}));function c(e,a){var n=arguments,r=a&&a.mdxType;if("string"==typeof e||r){var o=n.length,l=new Array(o);l[0]=d;var i={};for(var s in a)hasOwnProperty.call(a,s)&&(i[s]=a[s]);i.originalType=e,i.mdxType="string"==typeof e?e:r,l[1]=i;for(var m=2;m<o;m++)l[m]=n[m];return t.createElement.apply(null,l)}return t.createElement.apply(null,n)}d.displayName="MDXCreateElement"},7902:function(e,a,n){n.r(a),n.d(a,{frontMatter:function(){return i},contentTitle:function(){return s},metadata:function(){return m},toc:function(){return u},default:function(){return d}});var t=n(7462),r=n(3366),o=(n(7294),n(3905)),l=["components"],i={sidebar_position:4},s="Terraform",m={unversionedId:"herramientas/terraform",id:"herramientas/terraform",title:"Terraform",description:"Es una IaC tool que es open-source y cloud agnostic, usa lenguaje declarativo.",source:"@site/docs/herramientas/terraform.md",sourceDirName:"herramientas",slug:"/herramientas/terraform",permalink:"/docs/herramientas/terraform",editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/herramientas/terraform.md",tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4},sidebar:"tutorialSidebar",previous:{title:"GIT",permalink:"/docs/herramientas/git"},next:{title:"UI y UX",permalink:"/docs/herramientas/ux"}},u=[{value:"Traditional IT",id:"traditional-it",children:[{value:"Desventajas",id:"desventajas",children:[],level:3}],level:2},{value:"Cloud",id:"cloud",children:[],level:2},{value:"Configuracion Manual",id:"configuracion-manual",children:[{value:"Infraestructura como codigo",id:"infraestructura-como-codigo",children:[],level:3},{value:"Configuration Management",id:"configuration-management",children:[],level:3},{value:"Server Templating",id:"server-templating",children:[],level:3},{value:"Provisioning tools",id:"provisioning-tools",children:[],level:3},{value:"IaC Declarativa",id:"iac-declarativa",children:[],level:3},{value:"IaC Imperativa",id:"iac-imperativa",children:[],level:3}],level:2},{value:"Infrastructure lifecycle",id:"infrastructure-lifecycle",children:[],level:2},{value:"Key Terms",id:"key-terms",children:[{value:"Idempotent",id:"idempotent",children:[],level:3},{value:"Provisioning",id:"provisioning",children:[],level:3},{value:"Deployment",id:"deployment",children:[],level:3},{value:"Orchestration",id:"orchestration",children:[],level:3},{value:"Configuration Drift",id:"configuration-drift",children:[],level:3},{value:"Inmutable vs Mutable infraestructure",id:"inmutable-vs-mutable-infraestructure",children:[],level:3},{value:"GitOps",id:"gitops",children:[],level:3},{value:"Execution plan",id:"execution-plan",children:[],level:3}],level:2},{value:"Terraform Lifecycle",id:"terraform-lifecycle",children:[],level:2},{value:"CheatSheet",id:"cheatsheet",children:[],level:2},{value:"input Variables",id:"input-variables",children:[{value:"Locals",id:"locals",children:[],level:3},{value:"Default option",id:"default-option",children:[],level:3},{value:"List",id:"list",children:[],level:3},{value:"Objects",id:"objects",children:[],level:3},{value:"Types",id:"types",children:[],level:3},{value:"Validations",id:"validations",children:[],level:3},{value:"Environment variables",id:"environment-variables",children:[],level:3},{value:"Sensitive variables",id:"sensitive-variables",children:[],level:3},{value:"Cargar variables",id:"cargar-variables",children:[],level:3},{value:"jerarquia",id:"jerarquia",children:[],level:3}],level:2},{value:"Outputs",id:"outputs",children:[],level:2},{value:"Modulos",id:"modulos",children:[],level:2},{value:"Provisioners",id:"provisioners",children:[{value:"Local exec",id:"local-exec",children:[],level:3},{value:"Remote exec",id:"remote-exec",children:[],level:3},{value:"Conection block",id:"conection-block",children:[],level:3},{value:"File provisioner",id:"file-provisioner",children:[],level:3},{value:"Null resource",id:"null-resource",children:[],level:3}],level:2},{value:"Providers",id:"providers",children:[{value:"Modules",id:"modules",children:[{value:"Como usar modulos?",id:"como-usar-modulos",children:[],level:4},{value:"Como publicar modulos?",id:"como-publicar-modulos",children:[],level:4},{value:"Modulos verificados",id:"modulos-verificados",children:[],level:4},{value:"Estructura de los modulos",id:"estructura-de-los-modulos",children:[],level:4}],level:3}],level:2},{value:"Data Sources",id:"data-sources",children:[],level:2},{value:"Resources Meta Arguments",id:"resources-meta-arguments",children:[{value:"Depends on",id:"depends-on",children:[],level:3},{value:"count",id:"count",children:[],level:3},{value:"for_each",id:"for_each",children:[],level:3},{value:"provider",id:"provider",children:[],level:3},{value:"lifecycle",id:"lifecycle",children:[{value:"Resources Behaviour",id:"resources-behaviour",children:[],level:4},{value:"Lifecycle blocks",id:"lifecycle-blocks",children:[],level:4}],level:3},{value:"Provisioners",id:"provisioners-1",children:[],level:3}],level:2},{value:"terraform expresions",id:"terraform-expresions",children:[{value:"Types and values",id:"types-and-values",children:[],level:3},{value:"String and templates",id:"string-and-templates",children:[{value:"String Interpolation",id:"string-interpolation",children:[],level:4},{value:"String directive",id:"string-directive",children:[],level:4}],level:3},{value:"Operators",id:"operators",children:[],level:3},{value:"Conditional expressions",id:"conditional-expressions",children:[],level:3},{value:"For expressions",id:"for-expressions",children:[],level:3},{value:"Splat expressions",id:"splat-expressions",children:[],level:3},{value:"Dynamic blocks",id:"dynamic-blocks",children:[],level:3},{value:"Version constraints",id:"version-constraints",children:[],level:3}],level:2},{value:"Terraform state",id:"terraform-state",children:[{value:"Comandos",id:"comandos",children:[],level:3},{value:"terraform state mv",id:"terraform-state-mv",children:[],level:3},{value:"terraform state backups",id:"terraform-state-backups",children:[],level:3}],level:2},{value:"debugging and troubleshooting",id:"debugging-and-troubleshooting",children:[{value:"Debugging",id:"debugging",children:[],level:3},{value:"Troubleshooting",id:"troubleshooting",children:[{value:"Logs",id:"logs",children:[],level:4},{value:"Crash Log",id:"crash-log",children:[],level:4}],level:3}],level:2},{value:"Notas importantes",id:"notas-importantes",children:[{value:"terraform init",id:"terraform-init",children:[],level:3},{value:"Terraform get",id:"terraform-get",children:[],level:3},{value:"Terraform plan",id:"terraform-plan",children:[],level:3},{value:"Terraform apply",id:"terraform-apply",children:[],level:3}],level:2},{value:"Drift",id:"drift",children:[],level:2},{value:"Workflows",id:"workflows",children:[{value:"Individuales",id:"individuales",children:[],level:3},{value:"Equipos",id:"equipos",children:[],level:3},{value:"Equipos usando terraform cloud",id:"equipos-usando-terraform-cloud",children:[],level:3}],level:2},{value:"Backends",id:"backends",children:[{value:"Inicializacion del Backend",id:"inicializacion-del-backend",children:[],level:3},{value:"terraform_remote_state",id:"terraform_remote_state",children:[],level:3},{value:"Bloqueo del estado",id:"bloqueo-del-estado",children:[],level:3},{value:"Proteger informacion sensible",id:"proteger-informacion-sensible",children:[],level:3},{value:"Ignore files",id:"ignore-files",children:[],level:3}],level:2},{value:"Complex Types",id:"complex-types",children:[{value:"Collection types",id:"collection-types",children:[],level:3},{value:"Structural types",id:"structural-types",children:[],level:3}],level:2},{value:"Built-in Functions",id:"built-in-functions",children:[{value:"Numeric",id:"numeric",children:[],level:3},{value:"String",id:"string",children:[],level:3},{value:"Collection",id:"collection",children:[],level:3},{value:"Encoding",id:"encoding",children:[],level:3},{value:"Decoding",id:"decoding",children:[],level:3},{value:"Filesystem",id:"filesystem",children:[],level:3},{value:"Date and time",id:"date-and-time",children:[],level:3},{value:"Hash and Cripto",id:"hash-and-cripto",children:[],level:3},{value:"Ip network",id:"ip-network",children:[],level:3},{value:"Type conversion",id:"type-conversion",children:[],level:3}],level:2},{value:"Terraform cloud",id:"terraform-cloud",children:[{value:"Terminos",id:"terminos",children:[],level:3},{value:"Run workflows",id:"run-workflows",children:[],level:3},{value:"Organizational Level permissions",id:"organizational-level-permissions",children:[],level:3}],level:2}],p={toc:u};function d(e){var a=e.components,i=(0,r.Z)(e,l);return(0,o.kt)("wrapper",(0,t.Z)({},p,i,{components:a,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"terraform"},"Terraform"),(0,o.kt)("p",null,"Es una IaC tool que es open-source y cloud agnostic, usa lenguaje declarativo.\nUsa lenguaje HCL (HashiCorp Configuration Language), tiene features interesantes como:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Instalacion de modulos "),(0,o.kt)("li",{parentName:"ul"},"Cambios planeados y predictivos"),(0,o.kt)("li",{parentName:"ul"},"Grafico de dependencias"),(0,o.kt)("li",{parentName:"ul"},"Terraform registry ")),(0,o.kt)("h2",{id:"traditional-it"},"Traditional IT"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"arquitectura tradicional",src:n(4849).Z})),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Donde el equipo de ",(0,o.kt)("inlineCode",{parentName:"li"},"business")," son los encargados de decir que nuevas acciones se\ndebe implementar."),(0,o.kt)("li",{parentName:"ul"},"El equipo de ",(0,o.kt)("inlineCode",{parentName:"li"},"business analytics")," se encarga de evaular la efectividad y rentabilidad\nde dichas ideas priorizando las mejores ideas."),(0,o.kt)("li",{parentName:"ul"},"El ",(0,o.kt)("inlineCode",{parentName:"li"},"solutions architect")," es el encargado de maquetar la idea, es decir, pensar cuantos\nservidores se van a necesitar, firewalls, cual seria la mejor clase de storage, etc."),(0,o.kt)("li",{parentName:"ul"},"El equipo de ",(0,o.kt)("inlineCode",{parentName:"li"},"procurement")," se encarga de comprar todos los elements de la lista de materiales\nque el ",(0,o.kt)("inlineCode",{parentName:"li"},"solutions architect")," necesita para implementar la idea."),(0,o.kt)("li",{parentName:"ul"},"Una vez ya se cuente con todo el ",(0,o.kt)("inlineCode",{parentName:"li"},"hardware")," este para al ",(0,o.kt)("inlineCode",{parentName:"li"},"infraestructure team")," el cual se\nencarga de montar los elementos (",(0,o.kt)("inlineCode",{parentName:"li"},"field engineers"),"), aprovisionar del software (",(0,o.kt)("inlineCode",{parentName:"li"},"system administrators"),"),\naprovisionar bases de datos, storate (",(0,o.kt)("inlineCode",{parentName:"li"},"storage admins"),"), crear los horarios de backups (",(0,o.kt)("inlineCode",{parentName:"li"},"backups admins"),")."),(0,o.kt)("li",{parentName:"ul"},"Por ultimo los ",(0,o.kt)("inlineCode",{parentName:"li"},"desarrolladores")," ya se encuentran listos para desplegar sus desarrollos en dicho hardware.")),(0,o.kt)("h3",{id:"desventajas"},"Desventajas"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Tiempos de espera muy elevados "),(0,o.kt)("li",{parentName:"ul"},"Costos elevados "),(0,o.kt)("li",{parentName:"ul"},"Dificultad en la automatizacion (no puedes automatizar que monten un rack o conectar cables)"),(0,o.kt)("li",{parentName:"ul"},"Errores humanos "),(0,o.kt)("li",{parentName:"ul"},"Inconsistencia en los ambientes "),(0,o.kt)("li",{parentName:"ul"},"No todos los recursos los consumes ")),(0,o.kt)("h2",{id:"cloud"},"Cloud"),(0,o.kt)("p",null,"Debido a que hemos visto las desventajas de usar el modelo anterior, la nube nos ayuda mucho ya que\nno debemos manejar todos los gastos de infraestructura o hardware (",(0,o.kt)("inlineCode",{parentName:"p"},"Capex"),") sino mas bien nos enfocamos\nen usar esos recursos que ya estan disponibles por el ",(0,o.kt)("inlineCode",{parentName:"p"},"CSP"),". Esto hace que:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Nuestros tiempos se reduzcan"),(0,o.kt)("li",{parentName:"ul"},"Costos reducidos, ",(0,o.kt)("inlineCode",{parentName:"li"},"pays as you go")),(0,o.kt)("li",{parentName:"ul"},"Podemos automatizar el levantar un server nuevo (Porque el ",(0,o.kt)("inlineCode",{parentName:"li"},"CSP")," ya tiene levantado los servers y cuenta con APIS)."),(0,o.kt)("li",{parentName:"ul"},"Podamos escalar de forma horizontal o vertical sin problemas por ende ya no hay tanto desperdicio de recursos.")),(0,o.kt)("h2",{id:"configuracion-manual"},"Configuracion Manual"),(0,o.kt)("p",null,"Configurar de forma manual nuestra infraestructura en la nube ayuda a que podamos prototipar y\nusar nuevos servicios que el proveedor de nube crea. Pero este metodo tambien viene con varios problemas "),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Es facil desconfigurar un servicio que ya este funcionando (error humano)"),(0,o.kt)("li",{parentName:"ul"},"Es dificil de manejar estados de los servicios "),(0,o.kt)("li",{parentName:"ul"},"Es dificil transferir configuraciones de servicios con el equipo")),(0,o.kt)("h3",{id:"infraestructura-como-codigo"},"Infraestructura como codigo"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"IaC")," es la forma en la que nosotros declaramos nuestra infraestructura como un blueprint,\nestos scripts los utilizamos para provisionar (crear, actualizar o eliminar) los\nrequerimientos de hardware que se necesiten de una forma consistente y automatizada.\nPodemos utilizar herramientas para llevar esto a cabo, las dos mas usadas son:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"Ansible")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"Terraform"))),(0,o.kt)("p",null,"Ambas tecnologias tienen sus diferencias por ende tienen diferentes casos de uso."),(0,o.kt)("p",null,"Algunas otras tecnologias para ",(0,o.kt)("inlineCode",{parentName:"p"},"IaC"),":"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"puppet")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"saltstack")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"packer")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"cloudformation")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"vagrant")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"docker"))),(0,o.kt)("p",null,"Como cada una de estas herramientas estan creadas para casos especificos podemos crear grupos:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"p"},"Configuration Management")),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"puppet"),", ",(0,o.kt)("inlineCode",{parentName:"li"},"ansible"),", ",(0,o.kt)("inlineCode",{parentName:"li"},"saltstack")))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"p"},"Server templating")),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"docker"),", ",(0,o.kt)("inlineCode",{parentName:"li"},"packer"),", ",(0,o.kt)("inlineCode",{parentName:"li"},"vagrant")))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"p"},"Provisioning tools")),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"cloudformation"),", ",(0,o.kt)("inlineCode",{parentName:"li"},"terraform"))))),(0,o.kt)("h3",{id:"configuration-management"},"Configuration Management"),(0,o.kt)("p",null,"Esto se usa para mantener infraestructura, instalar (instalar dependencias) y manejar software\n(actualizar dependencias o eliminarlas), crear scripts de backups, la idea es que si tienes que\nhacer una actualizacion de una dependencia en 100 maquinas no debas ir una por una actualizando\nsino que con un script de ",(0,o.kt)("inlineCode",{parentName:"p"},"ansible")," ejecutes todas de golpe. "),(0,o.kt)("p",null,"Asi podemos tener ",(0,o.kt)("inlineCode",{parentName:"p"},"control de versiones"),", dentro de nuestros ambientes o instancias."),(0,o.kt)("p",null,"Tambiente es ",(0,o.kt)("a",{parentName:"p",href:"#idempotent"},"idempotent"),"."),(0,o.kt)("h3",{id:"server-templating"},"Server Templating"),(0,o.kt)("h3",{id:"provisioning-tools"},"Provisioning tools"),(0,o.kt)("h3",{id:"iac-declarativa"},"IaC Declarativa"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Todo se maneja de forma explicita, es decir lo que escribes es lo que obtienes"),(0,o.kt)("li",{parentName:"ul"},"Mas verbosa, por ende menos chance de desconfigurar "),(0,o.kt)("li",{parentName:"ul"},"Usa scripting languages.(JSON, XML, YAML)")),(0,o.kt)("p",null,"Ejemplos:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"ARM Templates (Azure)"),(0,o.kt)("li",{parentName:"ul"},"CLoud formation (AMAZON)"),(0,o.kt)("li",{parentName:"ul"},"Azure blueprint "),(0,o.kt)("li",{parentName:"ul"},"Cloud deployment manager (GCP)"),(0,o.kt)("li",{parentName:"ul"},"Terraform")),(0,o.kt)("h3",{id:"iac-imperativa"},"IaC Imperativa"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Tu dices que es lo que quieres y el resto se infiere"),(0,o.kt)("li",{parentName:"ul"},"menos verboso por ende tienes mas chance de crear alguna desconfiguracion "),(0,o.kt)("li",{parentName:"ul"},"Usa lenguajes de programacion (Python, Javascript, Ruby)")),(0,o.kt)("p",null,"Ejemplos "),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Amazon cloud development kit"),(0,o.kt)("li",{parentName:"ul"},"Pulumi")),(0,o.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"Aunque terraform es declarativo e ",(0,o.kt)("a",{parentName:"p",href:"#idempotent"},"idempotent")," tiene algunas features\ninteresantes de la IaC imperativa. El lenguaje que usa terraform es ",(0,o.kt)("strong",{parentName:"p"},"HCL-ish")," el cual soporta:"),(0,o.kt)("ul",{parentName:"div"},(0,o.kt)("li",{parentName:"ul"},"Bucles "),(0,o.kt)("li",{parentName:"ul"},"Bloques dinamicos "),(0,o.kt)("li",{parentName:"ul"},"Estructuras de datos complejas")))),(0,o.kt)("h2",{id:"infrastructure-lifecycle"},"Infrastructure lifecycle"),(0,o.kt)("p",null,"Son las fases claras y bien definidas que usan los Devops engineer para planear, dise\xf1ar\n, construir, testear, entregar y mantener infraestructura en la nube."),(0,o.kt)("p",null,"Hay una metodologia muy usada llamada Day 0 - Day 1 y Day 2"),(0,o.kt)("p",null,"Day 0 - 2 es una forma simplificada de describir las fases que tiene la infrastructure lifecycle"),(0,o.kt)("p",null,"Day 0 significa vamos a planear y dise\xf1ar\nDay 1 significa vamos a contruir y testear\nDay 2 significa vamos a salir a produccion y mantenerla "),(0,o.kt)("div",{className:"admonition admonition-warning alert alert--danger"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))),"warning")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"Los days no estan sujetos a los dias de 24 horas, pueden durar semanas, solo es una forma de decir"))),(0,o.kt)("h2",{id:"key-terms"},"Key Terms"),(0,o.kt)("h3",{id:"idempotent"},"Idempotent"),(0,o.kt)("p",null,"Lo que quiere decir es que podemos ejecutar el codigo multiples veces\ny siempre tendremos el mismo resultado, es decir, realizara los cambios necesarios para llevarlo\nal estado deseado."),(0,o.kt)("p",null,"Ejemplo\nSi tenemos un IaC config file con dos VM lo que pasara es que las creara y las lanzara"),(0,o.kt)("p",null,"Non-idempotent\nSi volvemos a ejecutar el IaC config file volvera a lanzar 2 VM a pesar de que ya\ntenemos dos VM ya en la nube por ende terminamos con 4 VM pero nosotros deseamos solo tener 2"),(0,o.kt)("p",null,"idempotent\nSi volvemos a ejecutar el IaC config file no pasara, porque ya tenemos 2 VM entonces o las\nactualizara o las destruira y creara."),(0,o.kt)("h3",{id:"provisioning"},"Provisioning"),(0,o.kt)("p",null,"Es cuando preparamos los servidores, con software, configuracion, data para que esten aptos para realizar\ntareas, es decir, cuando lanzamos y configuramos cualquier servicio de la nube estamos haciendo ",(0,o.kt)("inlineCode",{parentName:"p"},"provisioning"),".\nPodemos usar ",(0,o.kt)("a",{parentName:"p",href:"#configuration-management"},"config-managment-tools")),(0,o.kt)("h3",{id:"deployment"},"Deployment"),(0,o.kt)("p",null,"Es la accion de enviar una version de nuestra aplicacion a un servidor previamente provisionado."),(0,o.kt)("h3",{id:"orchestration"},"Orchestration"),(0,o.kt)("p",null,"Es la accion de coordinar multiples servicios. Esta mas relacionado con microservicios, contenedores."),(0,o.kt)("h3",{id:"configuration-drift"},"Configuration Drift"),(0,o.kt)("h3",{id:"inmutable-vs-mutable-infraestructure"},"Inmutable vs Mutable infraestructure"),(0,o.kt)("p",null,"Mutable\nEs cuando"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"desplegamos un servicio (terraform)"),(0,o.kt)("li",{parentName:"ol"},"configuramos con ansible (sudo ap update, install, etc).")),(0,o.kt)("p",null,"El problema con esto es que no podemos garantizar que siempre tendremos lo mismo porque las librerias\ncambian, los sistemas cambian, etc."),(0,o.kt)("p",null,"Inmutable\nEs cuando "),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"provisionamos un servicio (Terraform)"),(0,o.kt)("li",{parentName:"ol"},"creamos y almancenamos una imagen (packer)"),(0,o.kt)("li",{parentName:"ol"},"desplegamos")),(0,o.kt)("p",null,"Con la imagen podemos garantizar que siempre vamos a tener el mismo software y con terraform que siempre\ntendremos el mismo hardware."),(0,o.kt)("h3",{id:"gitops"},"GitOps"),(0,o.kt)("p",null,"Es cuando introducimos un proceso formal de revisar y aceptar cambios en la infraestructura, por medio de\nun repositorio de git e IaC files. Luego cuando ya el codigo este aceptado por medio de un trigger\nactualizamos dicha infraestructura."),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"gitops",src:n(4586).Z})),(0,o.kt)("h3",{id:"execution-plan"},"Execution plan"),(0,o.kt)("p",null,"es un review manual de los recursos que se van a agregar, actualizar o eliminar antes de aplicar\n",(0,o.kt)("inlineCode",{parentName:"p"},"terraform apply"),".\nPodemos visualizar el execution plan usando ",(0,o.kt)("inlineCode",{parentName:"p"},"terraform graph"),". Al ejecutar dicho compando obtendremos\nun archivo de tipo ",(0,o.kt)("strong",{parentName:"p"},"graphviz")," (Para poder visualizar el archivo necesitaremos GraphViz)"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"terraform graph | dot -Tsvg > graph.svg\n")),(0,o.kt)("p",null,"Terraform construye un grafico de dependencia para ejecutar el execution plan. Este dependecy graph\ntiene 3 tipo de elementos "),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Resource node (rectangulo): representa un recurso unico"),(0,o.kt)("li",{parentName:"ul"},"Resource meta-node (circulo): representa un grupo de recursos"),(0,o.kt)("li",{parentName:"ul"},"Provider configuration node (rombo): representa el proveedor de nube que usaremos.")),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"dependency-graph",src:n(9079).Z})),(0,o.kt)("h2",{id:"terraform-lifecycle"},"Terraform Lifecycle"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Creamos o configuramos nuestros terraform config file "),(0,o.kt)("li",{parentName:"ol"},"init, inicializamos el repositorio hacemos pull los proveedores y modulos que usaremos"),(0,o.kt)("li",{parentName:"ol"},"plan, creamos plan de ejecucion"),(0,o.kt)("li",{parentName:"ol"},"validate, validamos si los tipos y los valores son correctos "),(0,o.kt)("li",{parentName:"ol"},"apply, ejecutamos el plan de ejecucion (provisionamos la infraestructura)\n5.1. Destruimos la infraestructura remota (si es necesario)")),(0,o.kt)("h2",{id:"cheatsheet"},"CheatSheet"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"terraform init")," descarga los modulos y provisioners de nuestro main.tf file "),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"terraform fmt")," es como el linter de terraform, modifica los archivos\npara tener el style guide debio"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"terraform validate")," valida si nuestros manifiestos estan correctos o nos falta\nalguna configuracion"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"terraform plan")," crea el execution plan de los resources que se van a crear "),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"terraform apply")," ejecuta terraform plan y ademas crear los recursos del terrraform plan"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"terraform destroy o terraform apply -destroy")," para eliminar los recursos en la nube",(0,o.kt)("div",{parentName:"li",className:"admonition admonition-warning alert alert--danger"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))),"warning")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},(0,o.kt)("inlineCode",{parentName:"p"},"terraform validate")," no valida el valor de los campos solo que los campos necesarios\nexistan y contengan el tipo de dato que se indica"))))),(0,o.kt)("h2",{id:"input-variables"},"input Variables"),(0,o.kt)("p",null,"En terraform podemos crear variables para definir ciertos valores al momento de\nejecutar el apply. Esto nos ayuda a no quemar valores y que sean mas flexibles "),(0,o.kt)("p",null,"Opcion 1"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-terraform",metastring:"title='main.tf'",title:"'main.tf'"},'variable "nombre-de-la-variable" {\n    type = string \n\n}\n')),(0,o.kt)("p",null,"Luego para usar dicha varibale declarada en el ",(0,o.kt)("inlineCode",{parentName:"p"},"main.tf")," podemos hacer lo siguiente "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-terraform",metastring:"title='main.tf'",title:"'main.tf'"},'resource "recurso" "nombre-del-recurso"{\n    ami = var.nombre-de-la-variable\n}\n')),(0,o.kt)("p",null," y luego para ejecutarlo pasamos las variables en el comando "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'terrafrom plan -var=nombre-de-la-variable="t2.micro"\n')),(0,o.kt)("p",null,"Opcion 2"),(0,o.kt)("p",null,"Crear el archivo ",(0,o.kt)("inlineCode",{parentName:"p"},"terraform.tfvars")," y dentro del mismo agregar las variables "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-terraform",metastring:"title='terraform.tfvars'",title:"'terraform.tfvars'"},"nombre-de-la-variable='t2.medium'\n")),(0,o.kt)("p",null,"De esta manera podemos ejecutar ",(0,o.kt)("inlineCode",{parentName:"p"},"terraform plan")," sin necesidad de pasarle dichas variables\npor consola. Es como usar un archivo tipo ",(0,o.kt)("inlineCode",{parentName:"p"},".env")),(0,o.kt)("h3",{id:"locals"},"Locals"),(0,o.kt)("p",null,"Son como las variables pero hardcode y podemos usar string interpolation "),(0,o.kt)("p",null,"Para definir un local "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-terraform",metastring:"title='main.tf'",title:"'main.tf'"},"locals {\n    project_code = '003'\n}\n")),(0,o.kt)("p",null,"Para usar un local "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-terraform",metastring:"title='main.tf'",title:"'main.tf'"},'\nresource "recurso" "nombre-del-recurso"{\n    ami = var.nombre-de-la-variable\n    \n    tags = {\n        name = \'Servidor-${local.project_code}\'\n    }\n}\n')),(0,o.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"Para no tener todo (outputs, locals, variables) en el ",(0,o.kt)("inlineCode",{parentName:"p"},"main.tf")," podemos dividirlo en\narchivos como ",(0,o.kt)("inlineCode",{parentName:"p"},"variables.tf"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"output.tf")," y ",(0,o.kt)("inlineCode",{parentName:"p"},"providers.tf")," con esto generamos\nuna buena practica"))),(0,o.kt)("h3",{id:"default-option"},"Default option"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-terraform",metastring:"title='main.tf'",title:"'main.tf'"},'variable "nombre-de-la-variable" {\n    type = string \n    default = "hola"\n\n}\n')),(0,o.kt)("h3",{id:"list"},"List"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-terraform",metastring:"title='main.tf'",title:"'main.tf'"},'variable "nombre-de-la-variable" {\n    type = list(string )\n    default = ["hola"]\n\n}\n')),(0,o.kt)("h3",{id:"objects"},"Objects"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-terraform",metastring:"title='main.tf'",title:"'main.tf'"},'variable "nombre-de-la-variable" {\n    type = object({\n        internal = number \n        external = number \n        protocol = string \n    }) \n    default = {\n        internal = 10\n        externa = 20 \n        protocol = "tcp"\n    }\n\n}\n')),(0,o.kt)("h3",{id:"types"},"Types"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"number "),(0,o.kt)("li",{parentName:"ul"},"string "),(0,o.kt)("li",{parentName:"ul"},"boolean "),(0,o.kt)("li",{parentName:"ul"},"list"),(0,o.kt)("li",{parentName:"ul"},"set"),(0,o.kt)("li",{parentName:"ul"},"object"),(0,o.kt)("li",{parentName:"ul"},"map"),(0,o.kt)("li",{parentName:"ul"},"tuple")),(0,o.kt)("h3",{id:"validations"},"Validations"),(0,o.kt)("p",null,"POdemos usar un bloque de validacion con el fin de incremetar la seguridad\nde nuestros manifiestos y que las personas al ingresar variables no tengan\ntanto error humano "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-terrform"},'variable "image_id" {\n  type        = string\n  description = "The id of the machine image (AMI) to use for the server."\n\n  validation {\n    condition     = length(var.image_id) > 4 && substr(var.image_id, 0, 4) == "ami-"\n    error_message = "The image_id value must be a valid AMI id, starting with \\"ami-\\"."\n  }\n}\n')),(0,o.kt)("p",null,"Tambien podemos usar regex para realizar la validacion "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-terraform"},'variable "image_id" {\n  type        = string\n  description = "The id of the machine image (AMI) to use for the server."\n\n  validation {\n    # regex(...) fails if it cannot find a match\n    condition     = can(regex("^ami-", var.image_id))\n    error_message = "The image_id value must be a valid AMI id, starting with \\"ami-\\"."\n  }\n}\n\n')),(0,o.kt)("h3",{id:"environment-variables"},"Environment variables"),(0,o.kt)("p",null,"Para las variables de entorno debemos exportarlas con ",(0,o.kt)("inlineCode",{parentName:"p"},"TF_VAR_cualquier_cosa"),"\ncon esto logramos que terraform las entienda y las pueda asignar a los lugares\ncorrespondiendtes "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},'export TF_VAR_contrasena="123456789"\n')),(0,o.kt)("h3",{id:"sensitive-variables"},"Sensitive variables"),(0,o.kt)("p",null,"Podemos tener algunas variables que pueden ser sensibles como la contrase\xf1a de una base de datos\nen produccion o una ip de algun servidor de produccion, para evitar mostrar esto valores con\n",(0,o.kt)("inlineCode",{parentName:"p"},"terraform plan")," o ",(0,o.kt)("inlineCode",{parentName:"p"},"terraform apply"),", podemos usar el campo ",(0,o.kt)("inlineCode",{parentName:"p"},"sensitive = true")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-terraform"},'variable "user_information" {\n  type = object({\n    name    = string\n    address = string\n  })\n  sensitive = true\n}\n\nresource "some_resource" "a" {\n  name    = var.user_information.name\n  address = var.user_information.address\n}\n\n')),(0,o.kt)("p",null,"con esto obtenemos que no se muestren dichos valores en el execution plan."),(0,o.kt)("h3",{id:"cargar-variables"},"Cargar variables"),(0,o.kt)("p",null,"Hay variamos metodos para usar variables de entorno"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Crear un archivo ",(0,o.kt)("inlineCode",{parentName:"p"},"terraform.tfvars")," todas las variables en dicho archivo se cargan\nautomaticamente ")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Crear un archivo ",(0,o.kt)("inlineCode",{parentName:"p"},"dev.tfvars")," este archivo no se carga automaticamente debemos pasarlo\npor comando")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Crear un archivo ",(0,o.kt)("inlineCode",{parentName:"p"},"dev.auto.tfvars")," este archivo si se carga automaticamente ")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Por comando ",(0,o.kt)("inlineCode",{parentName:"p"},"-var-file dev.tfvars")," asi cargamos el archivo de la opcion 2 ")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Por comando tambien podemos modificar variables ",(0,o.kt)("inlineCode",{parentName:"p"},"-var ec2-type=t2.micro"))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"haciendo un export de ",(0,o.kt)("inlineCode",{parentName:"p"},"export TF_VAR_hola")))),(0,o.kt)("h3",{id:"jerarquia"},"jerarquia"),(0,o.kt)("p",null,"El nivel sobreescribe a todas las que estan abajo, es decir, el nivel 1 sobreescribe al 2,3 y4\nel 2 sobreescribe al 3 y 4, el 3 solo al 4 y el 4 no sobreescribe a nadie "),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Pasas por comando entonces ",(0,o.kt)("inlineCode",{parentName:"p"},"-var-file o -var ")," son las mas top ")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"*.auto.tfvars ")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"terraform.tfvars")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"environmental variables"))),(0,o.kt)("h2",{id:"outputs"},"Outputs"),(0,o.kt)("p",null,"Es una forma de obtener la informacion clave de los recursos que ya provisionamos."),(0,o.kt)("p",null,"Por ejemplo estamos reservando un ip publica, y queremos saber el valor de dicha ip.\nO estamos creando una VM y queremos saber su ip privada para crear una subnet o hacer networking."),(0,o.kt)("p",null,"Para todos esos casos debemos usar outputs."),(0,o.kt)("p",null,"Para definir un output"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-terraform",metastring:"title='main.tf'",title:"'main.tf'"},'output "instance_ip" {\n    value = aws_instance.my_server.public_ip #resource.name.atributo\n}\n')),(0,o.kt)("p",null,"Podemos usar ",(0,o.kt)("inlineCode",{parentName:"p"},"terraform output")," para ver todos los valores claves que definimos asi no tenemos\nque estar buscandolos en la pagina del proveedor o ejecutar multiples veces de terraform plan."),(0,o.kt)("p",null,"Tambien podemos saber el valor de un output en particular con ",(0,o.kt)("inlineCode",{parentName:"p"},"terraform output ${parametro}")),(0,o.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"En caso de que no funcione podemos hacer un ",(0,o.kt)("inlineCode",{parentName:"p"},"terraform refresh")))),(0,o.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"Para no tener todo (outputs, locals, variables) en el ",(0,o.kt)("inlineCode",{parentName:"p"},"main.tf")," podemos dividirlo en\narchivos como ",(0,o.kt)("inlineCode",{parentName:"p"},"variables.tf"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"output.tf")," y ",(0,o.kt)("inlineCode",{parentName:"p"},"providers.tf")," con esto generamos\nuna buena practica"))),(0,o.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"Algunos outputs podemos esconderlos para que al ejecutar terraform output no se muestren,\npero podemos seguir viendo dichos valores en el state file "),(0,o.kt)("p",{parentName:"div"},"tambien podemos pasar dos flags a ",(0,o.kt)("inlineCode",{parentName:"p"},"terraform output")," los cuales son ",(0,o.kt)("inlineCode",{parentName:"p"},"-json")," y ",(0,o.kt)("inlineCode",{parentName:"p"},"raw"),", el primero\nes una forma mas bonita de formatear los valores y el segundo es para usarlo en comandos de bash"))),(0,o.kt)("h2",{id:"modulos"},"Modulos"),(0,o.kt)("p",null,"Es una forma de agrupar diferentes resources en un modulo con el fin de que sea mas sencillo\nprovisionarlos sin tener que estar configurando uno a uno. Vendria a ser como una libreria de\nuna sola funcion en python como numpy o pandas. Podemos crear nuestros propios modulos\no usar los que nos ofrece terraform."),(0,o.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"En caso de que al ejecutar ",(0,o.kt)("inlineCode",{parentName:"p"},"terraform plan")," nos salga algun error, es muy probable que sea\nporque no tiene descargado dicho modulo por ende lo solucionamos si ejecutamos ",(0,o.kt)("inlineCode",{parentName:"p"},"terraform init")))),(0,o.kt)("p",null,"Ejemplo"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-terraform",metastring:"title='main.tf'",title:"'main.tf'"},"Falta google\n")),(0,o.kt)("h2",{id:"provisioners"},"Provisioners"),(0,o.kt)("p",null,"terraform provisioners son los que instalan software, editan archivos en las maquinas\nque fueron provisionadas por terraform para esto tiene dos provisioners:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"cloud-init Este es el estandar para la inicializacion de las instancias podemos pasarle\nun yaml o un script de bash "),(0,o.kt)("li",{parentName:"ul"},"packer es un servicio compilador de imagenes ")),(0,o.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"Se debe usar otros provisioners como ultimo recurso, normalmente hay mejores alternativas"))),(0,o.kt)("p",null,"Creamos un yaml de cloud init "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-yaml"},"")),(0,o.kt)("p",null,"luego se lo pasamos a terraform de la siguiente manera "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-terraform"},"")),(0,o.kt)("p",null,"Chef, salt and puppet son tools que estan dreprecated en terraform, y en general es\nconsiderado una mala practica"),(0,o.kt)("h3",{id:"local-exec"},"Local exec"),(0,o.kt)("p",null,"Local exec te permite ejecutar comandos locales luego de provisionar un recurso"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-terraform",metastring:"title='main.tf'",title:"'main.tf'"},'\nresource "aws_instance" "web" {\n    # ...\n\n    provisioner "local-exec"{\n        command = "echo ${self.private_ip}, $KEY, $SECRET >> private_ip.txt"\n        interpreter = [""]\n        environment = {\n            KEY = "dsasdasdas"\n            SECRET = "dasdasd"\n        }\n    }\n}\n')),(0,o.kt)("h3",{id:"remote-exec"},"Remote exec"),(0,o.kt)("p",null,"Nos permite ejecutar comandos en los recursos que ya provisionamos."),(0,o.kt)("p",null,"Tenemos tres modos que podemos ejecutar comandos:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"inline "),(0,o.kt)("li",{parentName:"ul"},"Script "),(0,o.kt)("li",{parentName:"ul"},"Scripts ")),(0,o.kt)("p",null,"Solo podemos usar un modo a la vez "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-terraform"},'resource "aws_instance" "web" {\n    # ...\n\n    provisioner "remote-exec"{\n        inline = [\n            "puppet apply",\n            "consul join ${aws_instance.web.private_ip}"\n        ]\n    }\n}\n')),(0,o.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"Para poder hacer remote-exec necesitaremos un conection block"))),(0,o.kt)("h3",{id:"conection-block"},"Conection block"),(0,o.kt)("p",null,"Nos permite establecer una conexion desde nuestro recurso provisionado "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-terraform"},'resource "aws_instance" "web" {\n    # ...\n\n    provisioner "file"{\n        source = "conf/secrets.yaml"\n        destination = "/etc/secrets.yaml"\n\n        connection {\n            type = \'ssh\'\n            user = \'root\'\n            password = "${var.password}"\n            host = "${var.host}"\n        }\n    }\n\n}\n')),(0,o.kt)("h3",{id:"file-provisioner"},"File provisioner"),(0,o.kt)("p",null,"Lo usamos para copiar archivos desde nuestra computadora a los\nrecursos que hemos provisionado"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-terraform"},'resource "aws_instance" "web" {\n    # ...\n\n    provisioner "file"{\n        source = "conf/secrets.yaml"\n        destination = "/etc/secrets.yaml"\n    }\n\n}\n')),(0,o.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"Para poder hacer remote-exec necesitaremos un conection block"))),(0,o.kt)("h3",{id:"null-resource"},"Null resource"),(0,o.kt)("p",null,"Es una forma de no crear ningun recurso pero podemos ejecutar comandos\nusando local-exec o usar triggers"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-terraform"},'\nresource "null_resource" "status" {\n    provider "local-exec" {\n        command = "echo ${self.private_ip}, $KEY, $SECRET >> private_ip.txt"\n    }\n    depends_on = [\n        aws_instance.my_server\n    ]\n} \n')),(0,o.kt)("h2",{id:"providers"},"Providers"),(0,o.kt)("p",null,"Son plugins que ayuda a terraform a poder interactuar con las distintos\nproveedores de nube como AWS, GCP o Azure, etc.\nHay tres tipos de providers "),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Official Publicado por la compa\xf1ia que tiene el servicio"),(0,o.kt)("li",{parentName:"ul"},"Verified Altamente mantenido por el proveedor y terraform "),(0,o.kt)("li",{parentName:"ul"},"Community Creado por la comunidad, no garantiza que este actualizado o mantenimiento.")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"terraform init")," nos ayuda a descargar los plugins y que podamos interactuar con los\nproveedores."),(0,o.kt)("p",null,"Terraform registry es la nube publica de terraform donde podemos\nencontrar los modulos y plugins publicos"),(0,o.kt)("p",null,"Terraform cloud ayuda a publicar modulos privados de tu organizacion"),(0,o.kt)("p",null,"Una forma de ver todos los providers de terraform es con "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"terraform providers\n")),(0,o.kt)("p",null,"Tenemos una forma de decir los provedores"),(0,o.kt)("p",null,"tambien podemos tener multiples providers con el alias "),(0,o.kt)("p",null,"Tambien podemos setear un proveedor "),(0,o.kt)("h3",{id:"modules"},"Modules"),(0,o.kt)("p",null,"Los modulos son grupos de archivos de configuraciones que provee configuraciones comunes\nal levantar infraestructura. "),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Por que usar Modulos?")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Buscan tener las mejores practicas "),(0,o.kt)("li",{parentName:"ul"},"reduce la cantidad de codigo"),(0,o.kt)("li",{parentName:"ul"},"Reduce el tiempo de desarrollo",(0,o.kt)("div",{parentName:"li",className:"admonition admonition-tip alert alert--success"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"Cuando usar terraform?\nPodemos usar terraform cuando tenemos tareas que solo se hacen una vez, como\ncrear usuarios, crear bases de datos, agregar la data en la db"))))),(0,o.kt)("p",null,"Podemos usar ansible, cuando?\nTenemos tareas repetitivas como hacer un backeup o truncar data diaria "),(0,o.kt)("p",null,"Usamos terraform registry para publicar nuestros modulos\n:::"),(0,o.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"Solo los modulos verificados aparecen en la barra de busqueda."))),(0,o.kt)("h4",{id:"como-usar-modulos"},"Como usar modulos?"),(0,o.kt)("p",null,"Tenemos modulos de tipo publico los cuales los encontramos en Terraform registry "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-hcl"},'module "consul"{\n  sources = "hashicorp/consul/aws" #<NAMESPACE>/<NAME>/<PROVIDER>\n  version = "1.0.2"\n}\n')),(0,o.kt)("p",null,"Tenemos modulos de tipo privado los cuales los encontramos en terraform cloud(Enterprise)"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-hcl"},'module "vpc"{\n  sources = "app.terraform.io/example_corp/vpc/aws" #<HOSTNAME>/<NAMESPACE>/<NAME>/<PROVIDER>\n  version = "1.0.2"\n}\n')),(0,o.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"Para usar los modulos privados debemos autenticarnos usando ",(0,o.kt)("inlineCode",{parentName:"p"},"terraform login")," en el terraform cloud\nTambien podemos usar un API_TOKEN y configurarlo en el cli"))),(0,o.kt)("h4",{id:"como-publicar-modulos"},"Como publicar modulos?"),(0,o.kt)("p",null,"Usamos terraform registry para publicar nuestro modulos publicos, ademas tenemos las siguientes ventajas:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Versionamiento "),(0,o.kt)("li",{parentName:"ol"},"Genera documentacion de forma automatica "),(0,o.kt)("li",{parentName:"ol"},"Historial"),(0,o.kt)("li",{parentName:"ol"},"READMES"),(0,o.kt)("li",{parentName:"ol"},"Ejemplos ")),(0,o.kt)("p",null,"Pasos para publicar un modulo\n(Usamos github para almacenar el codigo de nuestros modulos)"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Nombrar nuestro repositorios deben ser nombrados de una forma particular\n",(0,o.kt)("inlineCode",{parentName:"li"},"terraform-<PROVIDER>-<NAME>"),". "),(0,o.kt)("li",{parentName:"ol"},"Logear en terraform registry con nuestra cuenta de github."),(0,o.kt)("li",{parentName:"ol"},"Seleccionar el repositorio ")),(0,o.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"Para realizar actualizaciones a esos modulos usamos los tags de github. "))),(0,o.kt)("h4",{id:"modulos-verificados"},"Modulos verificados"),(0,o.kt)("p",null,"Todos los modulos verificados tienen un simbolo azul con un visto dentro.\nDichos modulos son mantenidos activamente por hashicorp y otros miembros\nde la comunidad."),(0,o.kt)("p",null,"No necesariamente los modulos que no son verificados quieren decir que son malos."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Existen modulos que no son verificados altamente mantenidos y con buenas features."),(0,o.kt)("li",{parentName:"ul"},"Existen modulos verificados que son solo buenos ejemplos.")),(0,o.kt)("h4",{id:"estructura-de-los-modulos"},"Estructura de los modulos"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"module-structure",src:n(5662).Z})),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"El punto de acceso es la carpeta root."),(0,o.kt)("li",{parentName:"ul"},"Tenemos 5 archivos requeridos (main.tf, variables.tf, outputs.tf, README, LICENSE)."),(0,o.kt)("li",{parentName:"ul"},"En los modulos anidados debemos usar path absolutos y no relativos."),(0,o.kt)("li",{parentName:"ul"},"Los modulos anidados sin README son considerados para uso interno.")),(0,o.kt)("h2",{id:"data-sources"},"Data Sources"),(0,o.kt)("p",null,"Es una forma que tiene terraform en conseguir informacion que este fuera de terraform\no de la computadora local "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-terraform"},'data "aws_ami" "example" {\n  most_recent = true\n\n  owners = ["self"]\n  tags = {\n    Name   = "app-server"\n    Tested = "true"\n  }\n}\n')),(0,o.kt)("p",null,"de esta manera podemos ir a aws y buscar dicha especificacion y una vez la obtengamos\npodemos usar dichos id para referenciar otros servicios de la siguiente manera"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-terraform"},'resource "aws_instance" "web" {\n  ami           = data.aws_ami.web.id\n  instance_type = "t1.micro"\n}\n')),(0,o.kt)("h2",{id:"resources-meta-arguments"},"Resources Meta Arguments"),(0,o.kt)("p",null,"Los resources representan objetos en nuestra infraestructura. ejemplo VM, DB, etc.\nAlgunos resources tienen un parametro ",(0,o.kt)("inlineCode",{parentName:"p"},"timeout")," que nos sirve para definir el tiempo\nen el que consideraremos si un recurso fallo al crearse."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-hcl"},'resource "aws_db_instance" "example" {\n\n  # ....\n\n  timeouts {\n    create = "60m"\n    delete = "2h"\n  }\n  \n}\n')),(0,o.kt)("p",null,"Podemos usar estos argumentos en cualquier recurso con el fin de cambiar\nsu comportamiento los mas comunes son:"),(0,o.kt)("h3",{id:"depends-on"},"Depends on"),(0,o.kt)("p",null,"con este argumento declaramos dependencia explicita entre recursos, es decir,\nel uno necesita que el otro este ready para poder provisionarlo. "),(0,o.kt)("p",null,"terraform hace esto de manera implicita pero hay momentos en lo ques la inferencia de\nterraform no es suficiente y necesitamos ser mas explicito al momento de provisionar\nrecursos "),(0,o.kt)("p",null,"ejemplo "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-terraform"},'\nresource "aws_iam_role_policy" "example" {\n  name   = "example"\n  role   = aws_iam_role.example.name\n  policy = jsonencode({\n    "Statement" = [{\n      "Action" = "s3:*",\n      "Effect" = "Allow",\n    }],\n  })\n}\n\nresource "aws_instance" "example" {\n  ami           = "ami-a1b2c3d4"\n  instance_type = "t2.micro"\n\n  # Terraform can infer from this that the instance profile must\n  # be created before the EC2 instance.\n  iam_instance_profile = aws_iam_instance_profile.example\n\n  # However, if software running in this EC2 instance needs access\n  # to the S3 API in order to boot properly, there is also a "hidden"\n  # dependency on the aws_iam_role_policy that Terraform cannot\n  # automatically infer, so it must be declared explicitly:\n  depends_on = [\n    aws_iam_role_policy.example,\n  ]\n}\n\n')),(0,o.kt)("h3",{id:"count"},"count"),(0,o.kt)("p",null,"para crear multiples replicas de un recursos basado en un valor "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-terraform"},'resource "aws_instance" "server" {\n  count = 4 # create four similar EC2 instances\n\n  ami           = "ami-a1b2c3d4"\n  instance_type = "t2.micro"\n\n  tags = {\n    Name = "Server ${count.index}"\n  }\n}\n\n')),(0,o.kt)("p",null,"Tambien podemos usar expresiones numericas "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-terraform"},'resource "aws_instance" "server" {\n  # ...\n  count = length(var.subnet_ids)\n  # ...\n}\n')),(0,o.kt)("h3",{id:"for_each"},"for_each"),(0,o.kt)("p",null,"para crear multiples replicas acorde a un map o set, esto nos ayuda a crear\nrecursos de una forma mas dinamica "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-terraform"},'resource "azurerm_resource_group" "rg" {\n  for_each = {\n    a_group = "eastus"\n    another_group = "westus2"\n  }\n  name     = each.key\n  location = each.value\n}\n\n')),(0,o.kt)("p",null,"Si queremos hacer lo mismo con un set "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-terraform"},'resource "aws_iam_user" "the-accounts" {\n  for_each = toset( ["Todd", "James", "Alice", "Dottie"] )\n  name     = each.key\n}\n\n')),(0,o.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"el each.value en los set seria ",(0,o.kt)("inlineCode",{parentName:"p"},"null")," "))),(0,o.kt)("h3",{id:"provider"},"provider"),(0,o.kt)("p",null,"para seleccionar otro proveedor con esto podemos hacer diferentes despliegues en\nmultiples zonas o multiples nubes "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-terraform"},'# The default provider configuration; resources that begin with `aws_` will use\n# it as the default, and it can be referenced as `aws`.\nprovider "aws" {\n  region = "us-east-1"\n}\n\n# Additional provider configuration for west coast region; resources can\n# reference this as `aws.west`.\nprovider "aws" {\n  alias  = "west"\n  region = "us-west-2"\n}\n\n')),(0,o.kt)("p",null,"ahora para usarlo en un recurso hacemos lo siguiente "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-terraform"},'resource "aws_instance" "foo" {\n  provider = aws.west\n\n  # ...\n}\n\n\n')),(0,o.kt)("h3",{id:"lifecycle"},"lifecycle"),(0,o.kt)("p",null,"para crear ciclos de vida custom y cambiar el comportamiento de los recursos "),(0,o.kt)("h4",{id:"resources-behaviour"},"Resources Behaviour"),(0,o.kt)("p",null,"Hay 3 comportamientos o estados basicos en los recursos "),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"p"},"create")," es cuando el recurso se encuentra definido en la configuracion pero\nno existe infraestructura fisica atada a el. Asociado con un (+)")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"p"},"destroy")," es cuando el recurso existe en el estado pero no en la configuracion.\nAsociado con un (-)")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"p"},"update-in-place")," es cuando los argumentos del recurso han sufrido modificaciones.\nAsociado con un (~)")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"p"},"destroy and recreate")," es cuando no podemos hacer una actualizacion del recursos\npor limitaciones del api. Asociado con un (-/+)\n"))),(0,o.kt)("h4",{id:"lifecycle-blocks"},"Lifecycle blocks"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-terraform"},'resource "azurerm_resource_group" "example" {\n  # ...\n\n  lifecycle {\n    create_before_destroy = true\n  }\n}\n')),(0,o.kt)("p",null,"tiene varios argumentos los cuales son:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"create_before_destroy (bool): ")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"prevent_destroy (bool):")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"ignore_changes (list of attributes): "))),(0,o.kt)("h3",{id:"provisioners-1"},"Provisioners"),(0,o.kt)("p",null,"para hacer funciones extras luego de crear el recurso "),(0,o.kt)("h2",{id:"terraform-expresions"},"terraform expresions"),(0,o.kt)("p",null,"Las expresiones nos ayudan a realizar calculo de valores sin configuraciones\nprevias."),(0,o.kt)("h3",{id:"types-and-values"},"Types and values"),(0,o.kt)("p",null,"El resultado de una expresion es un valor y por ende tiene un tipo de dato "),(0,o.kt)("p",null,"existen 3 grupos de tipos de datos:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Primitives")),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"string: son palabras o frases dentro de comillas dobles"),(0,o.kt)("li",{parentName:"ol"},"number: pueden ser enteros o decimales"),(0,o.kt)("li",{parentName:"ol"},"boolean: valores de verdad (True or False)")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"No type ")),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"null: no significa la ausencia de valor, por ende vendria a ser el valor por default de cada\nproveedor y se usa la palabra reservada ",(0,o.kt)("inlineCode",{parentName:"li"},"null"))),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#complex-types"},"complex/structural"))),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"list "),(0,o.kt)("li",{parentName:"ol"},"maps"),(0,o.kt)("li",{parentName:"ol"},"objects"),(0,o.kt)("li",{parentName:"ol"},"sets "),(0,o.kt)("li",{parentName:"ol"},"tuples")),(0,o.kt)("h3",{id:"string-and-templates"},"String and templates"),(0,o.kt)("p",null,"Por el momento terraform solo soporta comilla doble no comilla\nsimple esto es bueno porque podemos tener caracteres de escape\ncomo por ejemplo:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"\\n")," Salto de lionea"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"\\t")," Tab"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"\\r")," Enter"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"\\\\")," Backslash\nPodemos tener un string de multiples lineas para esto terraform\nmaneja el ",(0,o.kt)("inlineCode",{parentName:"li"},"heredoc")," style que es propio de los sistemas unix")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"<<EOT\nhello\nworld \nEOT\n")),(0,o.kt)("p",null,"Siempre empezaremos con ",(0,o.kt)("inlineCode",{parentName:"p"},"<<")," seguido de cualquier palabra en\nmayusculas y cerramos el tag con la misma palabra en mayusculas\ndentro de dicho tag todo lo que este sera considerado un string "),(0,o.kt)("h4",{id:"string-interpolation"},"String Interpolation"),(0,o.kt)("p",null,"Es la habilidad de evaluar una expresion entre llaves ",(0,o.kt)("inlineCode",{parentName:"p"},"${...}"),"\ny convertirlo en un string "),(0,o.kt)("p",null,"Ejemplo:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'"Hola, ${var.name}!"\n')),(0,o.kt)("h4",{id:"string-directive"},"String directive"),(0,o.kt)("p",null,"Permite evaluar condiciones logicas entre llaves ",(0,o.kt)("inlineCode",{parentName:"p"},"%{...}"),", para\nesto podemos usar interpolation de strings o HEREDOC. Con esto\npodemos usar ",(0,o.kt)("inlineCode",{parentName:"p"},"for loops")," o ",(0,o.kt)("inlineCode",{parentName:"p"},"if else")),(0,o.kt)("p",null,"Ejemplo:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"<<EOT\n%{ for ip in aws_instance.example.*.private_ip }\nserver ${ip}\n%{ endfor }\nEOT\n")),(0,o.kt)("h3",{id:"operators"},"Operators"),(0,o.kt)("p",null,"Al igual que cualquier lenguaje de programacion tenemos operadores\nestos pueden ser aritmetico o logicos "),(0,o.kt)("p",null,"Aritmeticos:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"multiplicacion ",(0,o.kt)("inlineCode",{parentName:"li"},"a*b")),(0,o.kt)("li",{parentName:"ul"},"division ",(0,o.kt)("inlineCode",{parentName:"li"},"a/b")),(0,o.kt)("li",{parentName:"ul"},"suma ",(0,o.kt)("inlineCode",{parentName:"li"},"a + b")),(0,o.kt)("li",{parentName:"ul"},"resta ",(0,o.kt)("inlineCode",{parentName:"li"},"a - b")),(0,o.kt)("li",{parentName:"ul"},"residuo ",(0,o.kt)("inlineCode",{parentName:"li"},"a % b"))),(0,o.kt)("p",null,"Condicionales:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Igual ",(0,o.kt)("inlineCode",{parentName:"li"},"a==b")),(0,o.kt)("li",{parentName:"ul"},"diferente ",(0,o.kt)("inlineCode",{parentName:"li"},"a!=b")),(0,o.kt)("li",{parentName:"ul"},"menor ",(0,o.kt)("inlineCode",{parentName:"li"},"a<b")),(0,o.kt)("li",{parentName:"ul"},"menor igual ",(0,o.kt)("inlineCode",{parentName:"li"},"a<=b")),(0,o.kt)("li",{parentName:"ul"},"mayor ",(0,o.kt)("inlineCode",{parentName:"li"},"a>b")),(0,o.kt)("li",{parentName:"ul"},"mayor igual ",(0,o.kt)("inlineCode",{parentName:"li"},"a>=b"))),(0,o.kt)("p",null,"Logicos:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Or ",(0,o.kt)("inlineCode",{parentName:"li"},"a||b")),(0,o.kt)("li",{parentName:"ul"},"and ",(0,o.kt)("inlineCode",{parentName:"li"},"a&&b")),(0,o.kt)("li",{parentName:"ul"},"not ",(0,o.kt)("inlineCode",{parentName:"li"},"!a"))),(0,o.kt)("h3",{id:"conditional-expressions"},"Conditional expressions"),(0,o.kt)("p",null,"Usamos el operador ternario ",(0,o.kt)("inlineCode",{parentName:"p"},"?")," para hacer ",(0,o.kt)("inlineCode",{parentName:"p"},"if else")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"condicion ? valor true : valor false\n")),(0,o.kt)("p",null,"Ejemplo "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-hcl"},'var.a != "" ? var.a : "default-a"\n')),(0,o.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"Los valores que se retornan deben ser del mismo tipo, no puedo\nretornar en el valor true un numero y en el falso un string"))),(0,o.kt)("h3",{id:"for-expressions"},"For expressions"),(0,o.kt)("p",null,"Nos ayuda a iterar un tipo de dato complejo y aplicarle transformaciones.\nPodemos recibir ",(0,o.kt)("inlineCode",{parentName:"p"},"listas, set, tuples, maps, objects")),(0,o.kt)("p",null,"Si tenemos ",(0,o.kt)("inlineCode",{parentName:"p"},"[]")," regresaremos una tupla\nSi tenemos ",(0,o.kt)("inlineCode",{parentName:"p"},"{}")," regresaremos un objeto"),(0,o.kt)("p",null,"Para listas o sets "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-hcl"},'[for s in var.list : upper(s)] ---\x3e ["HELLO", "WORLD"]\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-hcl"},'{for s in var.list : upper(s)} ---\x3e {hello = "HELLO", world ="WORLD"}\n')),(0,o.kt)("p",null,"Para map u objetos"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-hcl"},"[for k, v in var.map : length(k) + length(v)]\n")),(0,o.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"En las listas tambien podemos obtener el indice del elemento algo\nsimilar a usar el metodo enumerate de python "),(0,o.kt)("pre",{parentName:"div"},(0,o.kt)("code",{parentName:"pre",className:"language-hcl"},'[for i, e in var.list : "${i}, ${e}" ]\n')),(0,o.kt)("p",{parentName:"div"},"Tambien podemos reducir la cantidad de elementos que retornamos en el for\nusando un ",(0,o.kt)("inlineCode",{parentName:"p"},"if else")),(0,o.kt)("pre",{parentName:"div"},(0,o.kt)("code",{parentName:"pre",className:"language-hcl"},'[for e in var.list : upper(e) if e != ""]\n')))),(0,o.kt)("h3",{id:"splat-expressions"},"Splat expressions"),(0,o.kt)("p",null,"Es una forma corta de usar un bucle for. Esto lo hacemos usando el\nsplat operator ",(0,o.kt)("inlineCode",{parentName:"p"},"*")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-hcl"},"[for o in var.list : o.id] -> var.list[*].id\n[for o in var.list : o.interface[0].name -> var.list[*].interface[0].name]\n")),(0,o.kt)("h3",{id:"dynamic-blocks"},"Dynamic blocks"),(0,o.kt)("p",null,"Nos ayuda a construir bloques de codigo anidados que se repetiran a lo\nlargo de nuestro codigo de terraform, debemos usar la palabra reservada\n",(0,o.kt)("inlineCode",{parentName:"p"},"dynamics")," y actuara como un bucle for"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-hcl"},'resource "aws_elastic_beanstalk_environment" "tfenvtest" {\n  name                = "tf-test-name"\n  application         = "${aws_elastic_beanstalk_application.tftest.name}"\n  solution_stack_name = "64bit Amazon Linux 2018.03 v2.11.4 running Go 1.12.6"\n\n  dynamic "setting" {\n    for_each = var.settings\n    content {\n      namespace = setting.value["namespace"]\n      name = setting.value["name"]\n      value = setting.value["value"]\n    }\n  }\n}\n\n')),(0,o.kt)("h3",{id:"version-constraints"},"Version constraints"),(0,o.kt)("h2",{id:"terraform-state"},"Terraform state"),(0,o.kt)("p",null,"Que es un estado ?"),(0,o.kt)("p",null,"Un estado es una condicion particular en el que estan los recursos en la nube\nen un periodo de tiempo"),(0,o.kt)("p",null,"Como terraform preserva el estado?"),(0,o.kt)("p",null,"Cuando provisonamos recursos en la nube, terraform crea un archivo de estado\nllamado ",(0,o.kt)("inlineCode",{parentName:"p"},"terraform.tfstate"),", este archivo es un json y contiene un mapeo 1 a 1\nde los recursos de instancia con los recursos en la nube "),(0,o.kt)("h3",{id:"comandos"},"Comandos"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"terraform state list"),": lista los resources en el state"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"terraform state mv"),": Mueve o cambia de nombre un elemento del estado "),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"terraform state pull"),": Se baja el remote state y lo imprime en consola "),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"terraform state push"),": actualiza el remote state con el local state "),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"terraform state replace-provider"),": Cambia el provider del state"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"terraform state rm"),": elimina recursos del state"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"terraform state show"),": Muestra un recurso del state")),(0,o.kt)("h3",{id:"terraform-state-mv"},"terraform state mv"),(0,o.kt)("p",null,"Si solo le cambiamos el nombre a un recurso o lo movemos a un modulo\nal aplicar terraform apply. terraform destruira el recurso y lo generara de nuevo\nsino queremos que esto pase podemos usar terraform state mv para renombrar\nel recurso sin la accion de borrarlo y recrearlo."),(0,o.kt)("p",null,"Para renombrar "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"terraform state mv packet_device.worker packer_devices.helper\n")),(0,o.kt)("p",null,"Para mover un recurso a un modulo "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"terraform state mv packet_device.worker module.worker.packet_devices.worker\n")),(0,o.kt)("p",null,"Para mover un modulo dentro de un modulo"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"terraform state mv module.app module.parent.module.app\n")),(0,o.kt)("h3",{id:"terraform-state-backups"},"terraform state backups"),(0,o.kt)("p",null,"Todos los subcomandos de terraform state que modifican el estado\ncrearan un archivo backup. ",(0,o.kt)("inlineCode",{parentName:"p"},"list y show")," como solo leen no crean un backup\neste archivo se llamada ",(0,o.kt)("inlineCode",{parentName:"p"},"terraform.tfstate.backup"),". POr buenas practicas siempre\nse creara un archivo de tipo backup."),(0,o.kt)("h2",{id:"debugging-and-troubleshooting"},"debugging and troubleshooting"),(0,o.kt)("h3",{id:"debugging"},"Debugging"),(0,o.kt)("p",null,"Como cualquier otra tool de codigo, tendremos ocasiones donde queremos debuguear\nnuestros archivos o necesitamos probar funcionalidades para esto terraform tiene\n3 comandos bastante utiles. "),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"p"},"terraform fmt")," Re-escribe los archivos de configuraciones cumpliendo el formato y\nestilo propio de terraform. Una opcion mas verbosa para ver que archivos se modificaron\nes usar ",(0,o.kt)("inlineCode",{parentName:"p"},"terraform fmt --diff"))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"p"},"terraform validate")," Valida la sintaxis y los argumentos de los archivos. es decir, si\na un modulo le hace falta que le pasemos un parametro. Esto no valida que el argumento que\npasemos sea valido, es decir, debo pasarle un string y le paso ",(0,o.kt)("inlineCode",{parentName:"p"},"dasdads")," solo valida que\nsea un string no su contenido.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"p"},"terraform console")," Una shell interativa para evaluar expresiones."))),(0,o.kt)("h3",{id:"troubleshooting"},"Troubleshooting"),(0,o.kt)("p",null,"En terraform tenemos 4 tipo de errores principales los cuales son:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Language errors: Syntax error"),(0,o.kt)("li",{parentName:"ol"},"State errors: El estado de nuestros recursos fue cambiada del estado esperado"),(0,o.kt)("li",{parentName:"ol"},"Core errors: Bug en la libreria core"),(0,o.kt)("li",{parentName:"ol"},"Provider errors: La api del proveedor cambio y debemos hacer cambios")),(0,o.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"las dos primeras son super sencillas de resolver, mientras que las dos ultimas son\ndificiles de resolver."),(0,o.kt)("p",{parentName:"div"},"Para la primera podemos usar ",(0,o.kt)("inlineCode",{parentName:"p"},"terraform fmt"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"validate"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"version"),"\nPara la segunda podemos usar ",(0,o.kt)("inlineCode",{parentName:"p"},"terraform refresh"),"\nPara las dos ultimas podemos usar los logs para obtener info ",(0,o.kt)("inlineCode",{parentName:"p"},"TF_LOG")," y abrir un issue\nen github"))),(0,o.kt)("h4",{id:"logs"},"Logs"),(0,o.kt)("p",null,"Podemos activar los logs de terraform usan las variables de entorno ",(0,o.kt)("inlineCode",{parentName:"p"},"TF_LOG environment"),"\nPara environment tenemos los siguientes valores:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"TRACE"),(0,o.kt)("li",{parentName:"ul"},"DEBUG "),(0,o.kt)("li",{parentName:"ul"},"INFO"),(0,o.kt)("li",{parentName:"ul"},"WARN"),(0,o.kt)("li",{parentName:"ul"},"ERROR"),(0,o.kt)("li",{parentName:"ul"},"JSON")),(0,o.kt)("p",null,"Podemos habilitarlo de forma separada usando :"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"TF_LOG_CORE")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"TF_LOG_PROVIDER"))),(0,o.kt)("p",null,"Para modificar el path donde se guardan los logs podemos usar la variable ",(0,o.kt)("inlineCode",{parentName:"p"},"TF_LOG_PATH")),(0,o.kt)("p",null,"Estos comando los pasamos por ejemplo antes del comando ",(0,o.kt)("inlineCode",{parentName:"p"},"terraform apply"),".\nEjemplo"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"TF_LOG=CORE TF_LOG_PATH=./terraform.log terraform apply \n")),(0,o.kt)("h4",{id:"crash-log"},"Crash Log"),(0,o.kt)("p",null,"terraform utiliza por detras el lenguaje de programacion go y las go rutines para que\ncuando pase algo se ejecute dicho evento de panico y guarde un archivo de logs. Esto nos\nsera util para crear el issue en github."),(0,o.kt)("h2",{id:"notas-importantes"},"Notas importantes"),(0,o.kt)("p",null,"Algunas notas sobre los comandos mas en detalle."),(0,o.kt)("h3",{id:"terraform-init"},"terraform init"),(0,o.kt)("p",null,"Inicializa nuestro proyecto de terraform realizando:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"La descarga de los plugins.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"crea un directorio de terraform ",(0,o.kt)("inlineCode",{parentName:"p"},".terraform"),". ")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"crea un archivo de dependencias con el fin de forzar que todos tengan las mimas\nversiones.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"p"},"terraform init -upgrade"))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"p"},"terraform init -get-plugins-false"))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"p"},"terraform init -plugin-dir=$PATH"))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"p"},"terraform init -lockfile=MODE")))),(0,o.kt)("h3",{id:"terraform-get"},"Terraform get"),(0,o.kt)("p",null,"Es parecido al ",(0,o.kt)("inlineCode",{parentName:"p"},"terraform init")," con la diferencia que buscamos actualizar\nmodulos locales o descargarnos los ultimos cambios de dichos modulos. No queremos\nnuevas actualizaciones de proovedores o cambiar el estado por eso no usamos\n",(0,o.kt)("inlineCode",{parentName:"p"},"terraform init")),(0,o.kt)("h3",{id:"terraform-plan"},"Terraform plan"),(0,o.kt)("p",null,"Crea un ",(0,o.kt)("inlineCode",{parentName:"p"},"execution plan")," el cual es un archivo binario. Un ",(0,o.kt)("inlineCode",{parentName:"p"},"execution plan")," consiste en:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Lee el estado remoto de los objetos con el fin de asegurarse que el estado este al dia ")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Compara las configuraciones con el fin de pdoer notar los cambios.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Propone un set de cambios que se deberian aplicar para que ambas configuraciones esten iguales."))),(0,o.kt)("p",null,"Este comando no ejecuta los cambios, solo los propone."),(0,o.kt)("p",null,"Existen dos tipos de plan:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Planes especulativos cuando ejecutamos ",(0,o.kt)("inlineCode",{parentName:"p"},"terraform plan")," ")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Planes guardados: podemos guardar nuestros planes de ejecucion usando el flag ",(0,o.kt)("inlineCode",{parentName:"p"},"--out")," de la\nsiguiente manera ",(0,o.kt)("inlineCode",{parentName:"p"},"terraform plan --out=mi-plan.plan"),". "))),(0,o.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("ul",{parentName:"div"},(0,o.kt)("li",{parentName:"ul"},"No hay name conventions para los nombres que usamos para guardar nuestros planes"),(0,o.kt)("li",{parentName:"ul"},"Suele ser util en pipelines de CI/CD")))),(0,o.kt)("h3",{id:"terraform-apply"},"Terraform apply"),(0,o.kt)("p",null,"Ejecuta los cambios propuestos en el ",(0,o.kt)("inlineCode",{parentName:"p"},"execution plan")),(0,o.kt)("p",null,"Como tenemos dos tipos de planes tambien tenemos dos tipos de terraform apply "),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Usando Automatic plan Mode.  Ejecutamos ",(0,o.kt)("inlineCode",{parentName:"p"},"terraform apply")," automaticamente aplica el validate,\ncrea el plan y lo ejecuta. En este modo si necesitaremos una aprobacion para ejecutar dicho plan.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Saved plan mode. Ejecutamos ",(0,o.kt)("inlineCode",{parentName:"p"},"terraform apply FILE")," automaticamente se crean los cambios\ncon el plan de execution que le enviamos."))),(0,o.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"Para inspeccionar el plan podemos usar ",(0,o.kt)("inlineCode",{parentName:"p"},"terraform show")))),(0,o.kt)("h2",{id:"drift"},"Drift"),(0,o.kt)("p",null,"Esto ocurre cuando nuestros recursos esperados estan en un estado diferente\na nuestro estado esperado."),(0,o.kt)("p",null,"Hay 3 formas de resolver dicho conflicto:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Remplazando recursos. Esto ocurre cuando un recurso esta da\xf1ado y terraform no lo reconoce.\nUsamos el flag ",(0,o.kt)("inlineCode",{parentName:"li"},"--replace"),". Antes usabamos ",(0,o.kt)("inlineCode",{parentName:"li"},"terraform taint")," para marcar los recursos que en un futuro\nquedaran deprecated. Pero desde la version ",(0,o.kt)("inlineCode",{parentName:"li"},"0.152")," este comando esta deprecated.")),(0,o.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"Con el comando ",(0,o.kt)("inlineCode",{parentName:"p"},'terraform apply --replace="aws_instance.my_ec2[0]"'),". solo podemos un\nrecurso a la vez"))),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Importando recursos. Cuando un recurso lo queremos agregar de forma manual al estado. Usamos\nel ",(0,o.kt)("inlineCode",{parentName:"li"},"--import"))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-hcl"},'resource "aws_instance" "example" {\n  # ... instance configuration ...\n}\n')),(0,o.kt)("p",null,"con esto al usar ",(0,o.kt)("inlineCode",{parentName:"p"},"terraform import aws_instance.example [id]")," importamos un recurso que creamos de\nforma manual en la consola. "),(0,o.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("ul",{parentName:"div"},(0,o.kt)("li",{parentName:"ul"},"No todos los recursos puden ser importados automaticamente al state file. Deberiamos revisar\nla documentacion para saber que recursos si tienen este feature."),(0,o.kt)("li",{parentName:"ul"},"Solo podemos importar un recurso a la vez")))),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Actualizando el estado. Lee la configuracion actual de todos los recursos remotos y actualiza\nel estado para los cambios. Sin realizar cambios en nuestra infraestructura remota.")),(0,o.kt)("p",null,"Podemos usar ",(0,o.kt)("inlineCode",{parentName:"p"},"terraform refresh")," el cual es un alias para   ",(0,o.kt)("inlineCode",{parentName:"p"},"terraform apply --auto-approve --refresh-only")),(0,o.kt)("p",null,"Consideremos el siguiente escenario para que se entienda mejor."),(0,o.kt)("p",null,"Creamos un script para que provisione una maquina virtual en aws. A uno de nuestros ingenieros le decimos\nque elimine la maquina virtual y el en vez de modificar el script lo elimina directo de la consola. "),(0,o.kt)("p",null,"Si ejecutamos terraform apply. "),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Asumira que el estado es correcto,que nos hace falta una maquina virtual "),(0,o.kt)("li",{parentName:"ol"},"Propondra provisionar una vm ")),(0,o.kt)("p",null,"Si ejecutamos ",(0,o.kt)("inlineCode",{parentName:"p"},"terraform apply --refresh-only")),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Se dara cuenta que la maquina virtual que creamos falta "),(0,o.kt)("li",{parentName:"ol"},"Se dara cuenta que el evento que la maquina virtual no este es aproposito."),(0,o.kt)("li",{parentName:"ol"},"propondra cambiar el estado y no creara una maquina virtual.")),(0,o.kt)("h2",{id:"workflows"},"Workflows"),(0,o.kt)("p",null,"Las 3 fases basicas son:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Escribir -> Escribir la infraestructura que vamos a provisionar"),(0,o.kt)("li",{parentName:"ol"},"Plan -> Crear el plan de ejecucion"),(0,o.kt)("li",{parentName:"ol"},"Apply -> Provisionar infraestructura")),(0,o.kt)("p",null,"A medida que los grupos van creciendo los workflows deben ir evolucionando\ntenemos 3 tipos de workflows a medida que los equipos van creciendo"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Indivual "),(0,o.kt)("li",{parentName:"ul"},"Equipos que usan solo terraform "),(0,o.kt)("li",{parentName:"ul"},"Equipos que usan terraform cloud")),(0,o.kt)("h3",{id:"individuales"},"Individuales"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Escribir ")),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Escribimos nuestros archivos de terraform en cualquier editor de texto "),(0,o.kt)("li",{parentName:"ol"},"Guardamos nuestros cambios usando VCS (Version control system) como git"),(0,o.kt)("li",{parentName:"ol"},"Usamos de forma repetitiva ",(0,o.kt)("inlineCode",{parentName:"li"},"terraform plan")," y ",(0,o.kt)("inlineCode",{parentName:"li"},"terraform validate")," para\nno tener errores de sintaxis")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Plan")),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Cuando ya no tenemos errores hacemos un commit local"),(0,o.kt)("li",{parentName:"ol"},"Solo usaremos una rama ",(0,o.kt)("inlineCode",{parentName:"li"},"main")),(0,o.kt)("li",{parentName:"ol"},"Cuando terminamos el proceso de commit pasamos al apply")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Apply")),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Ejecutamos ",(0,o.kt)("inlineCode",{parentName:"li"},"terraform apply")),(0,o.kt)("li",{parentName:"ol"},"Revisamos el plan de ejecucion "),(0,o.kt)("li",{parentName:"ol"},"Luego de que los cambios se hayan provisionado de forma exitosa hacemos un push\na nuestro repositorio remoto.")),(0,o.kt)("h3",{id:"equipos"},"Equipos"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Escribir ")),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Cada equipo escribe su codigo de forma local con su editor favorito"),(0,o.kt)("li",{parentName:"ol"},"Se crean ramas por equipo con el fin de poder manejar los conflictos "),(0,o.kt)("li",{parentName:"ol"},"Terraform plan puede ser un buen feedback para equipos peque\xf1os"),(0,o.kt)("li",{parentName:"ol"},"Para equipos mas largos las credenciales empiezan a ser un problema por ende\nusar un pipeline de CI/CD es lo mejor")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Plan")),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Cuando una rama esta lista procedemos a realizar el PR el cual generara el plan\nde ejecucion que lo adjuntamos en el PR para revision")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Apply")),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Una vez aprobado y mergeado el PR se procede a ejecutar el pipeline el mismo que\nejecutara el ",(0,o.kt)("inlineCode",{parentName:"li"},"terraform apply"))),(0,o.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"s ")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("ul",{parentName:"div"},(0,o.kt)("li",{parentName:"ul"},"El equipo de devops debe mantener y modificar los pipelines de CI/CD"),(0,o.kt)("li",{parentName:"ul"},"Se debe pensar como almancenar el ",(0,o.kt)("inlineCode",{parentName:"li"},"state file")),(0,o.kt)("li",{parentName:"ul"},"No podemos tener control de accesos o permisos, es decir, quien puede destruir\nrecursos, quien puede aplicarlos, etc."),(0,o.kt)("li",{parentName:"ul"},"Debemos gestionar como inyectar secrets de una forma segura"),(0,o.kt)("li",{parentName:"ul"},"Manejar multiples ambientes puede ser algo caotico.")))),(0,o.kt)("h3",{id:"equipos-usando-terraform-cloud"},"Equipos usando terraform cloud"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Escribir ")),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"usaremos terraform cloud como nuestro backend remoto"),(0,o.kt)("li",{parentName:"ol"},"Las variables las almacenamos en terraform cloud y no en nuestro computadora\nusando archivos ",(0,o.kt)("inlineCode",{parentName:"li"},".tfvars")),(0,o.kt)("li",{parentName:"ol"},"terraform cloud tiene integraciones con los VCS y automaticamente crea los pipelines"),(0,o.kt)("li",{parentName:"ol"},"Escribir el codigo de cada equipo en diferentes ramas.")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Plan ")),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Cuando una rama esta lista procedemos a realizar el PR el cual generara el plan\nde ejecucion que lo adjuntamos en el PR lo podemos revisar y comentar usando terraform cloud")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Apply ")),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Luego del PR sea mergeado terraform cloud ejecutara el apply. Una persona del equipo debe confirmar\ndichos cambios.")),(0,o.kt)("h2",{id:"backends"},"Backends"),(0,o.kt)("p",null,"Define donde y como las operaciones se ejecutan, ademas donde almacenamos las snapshots."),(0,o.kt)("p",null,"Existen dos tipos de terraform backends:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Standard backend")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"solo almacena los estados"),(0,o.kt)("li",{parentName:"ul"},"No podemos realizar operaciones como ",(0,o.kt)("inlineCode",{parentName:"li"},"terraform apply")),(0,o.kt)("li",{parentName:"ul"},"Son backends de terceros como aws s3")),(0,o.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"Algunas opciones de backends de terceros son:"),(0,o.kt)("ul",{parentName:"div"},(0,o.kt)("li",{parentName:"ul"},"S3 podemos lockear usando DynamoDB"),(0,o.kt)("li",{parentName:"ul"},"Azure blob storage lockeamos de forma integrada"),(0,o.kt)("li",{parentName:"ul"},"Google cloud storage lockeo de forma integrada"),(0,o.kt)("li",{parentName:"ul"},"Alibaba cloud object storage services lockear usando TableStore"),(0,o.kt)("li",{parentName:"ul"},"OpenStack Swift lockeo integrado"),(0,o.kt)("li",{parentName:"ul"},"Tencent cloud object storage lockeo integrado"),(0,o.kt)("li",{parentName:"ul"},"Manta lockeo integrado")),(0,o.kt)("p",{parentName:"div"},"Podemos usar servicios mas extravagantes "),(0,o.kt)("ul",{parentName:"div"},(0,o.kt)("li",{parentName:"ul"},"Hashicorp consul "),(0,o.kt)("li",{parentName:"ul"},"etcd"),(0,o.kt)("li",{parentName:"ul"},"postgresdb"),(0,o.kt)("li",{parentName:"ul"},"kubernetes secrets"),(0,o.kt)("li",{parentName:"ul"},"artifactory no tiene lockeo")))),(0,o.kt)("ol",{start:2},(0,o.kt)("li",{parentName:"ol"},"Enhanced backends ")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Podemos almacenar el estado "),(0,o.kt)("li",{parentName:"ul"},"Ejecutar comandos como ",(0,o.kt)("inlineCode",{parentName:"li"},"terraform apply"),"\nTenemos 2 tipos:"),(0,o.kt)("li",{parentName:"ul"},"Local: Archivos son guardados en la maquina local donde ejecutamos comandos."),(0,o.kt)("li",{parentName:"ul"},"Remote: Archivos e informacion es almacenada en la nube.")),(0,o.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"Los backups solo se guardan en la maquina local no en el backend remoto"))),(0,o.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("ul",{parentName:"div"},(0,o.kt)("li",{parentName:"ul"},"no necesitamos una cuenta de terraform cloud para crear remote backends"),(0,o.kt)("li",{parentName:"ul"},"si usamos un remote backend necesitamos configurar las credenciales de CSP")))),(0,o.kt)("h3",{id:"inicializacion-del-backend"},"Inicializacion del Backend"),(0,o.kt)("p",null,"Podemos usar un archivo con la configuracion del backend con el fin de ponerlo en un\ngitignore y que en nuestros repositorios no exista configuracion acerca de nuestro repositorios."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-hcl",metastring:"title=main.tf",title:"main.tf"},'\nterraform {\n  required_version = "~> 2.0.1"\n  backend "remote" {}\n}\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-hcl",metastring:"title=backend.hcl",title:"backend.hcl"},'workspace = {name = "workspace"}\nhostname = "app.terraform.io"\norganization = "company"\n')),(0,o.kt)("p",null,"Podemos usar el flag ",(0,o.kt)("inlineCode",{parentName:"p"},"-backend-config")," para pasar dicho archivo de configuracion"),(0,o.kt)("p",null,"ejemplo "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"terraform init --backend-config backend.hcl\n")),(0,o.kt)("h3",{id:"terraform_remote_state"},"terraform_remote_state"),(0,o.kt)("p",null,"Podemos obtener los outputs de otros archivos de estado por medio del data source\n",(0,o.kt)("inlineCode",{parentName:"p"},"terraform_remote_state")," el cual usa el ultimo snapshot del estado de la infraestructura."),(0,o.kt)("p",null,"Para backend remotos"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-hcl"},'\ndata "terraform_remote_state" "vpc" {\n  backend = "remote"\n  config = {\n    organization = "hashicorp"\n    workspaces = {\n      name = "prod"\n    }\n  }\n}\n\nresource "aws_instance" "example" {\n  subnet_id = data.terraform_remote_state.vpc.outputs.subnet_id\n}\n')),(0,o.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"Solos los outputs del modulo root seran expuestas, si tenemos modulos anidados\ndebemos explicitamente exponerlas tambien en el moodulo root, sino no podremos acceder"))),(0,o.kt)("p",null,"Para backend locales "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-hcl"},'\ndata "terraform_remote_state" "vpc" {\n  backend = "local"\n  config = {\n    path = "..."\n  }\n}\nresource "aws_instance" "example" {\n  subnet_id = data.terraform_remote_state.vpc.outputs.subnet_id\n}\n')),(0,o.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"usando los backend locales debemos pasarle la ruta absoluta del archivo de estado\nPodemos usar data sources como alternativa al ",(0,o.kt)("inlineCode",{parentName:"p"},"terraform_remote_state")," pero\nrecordemos que tendremos mas informacion sobre el recurso esto incluye informacion sensible"))),(0,o.kt)("h3",{id:"bloqueo-del-estado"},"Bloqueo del estado"),(0,o.kt)("p",null,"terraform de forma automatica bloquea el estado cada que se ejecuta una operacion\nde escritura. Esto ayuda a que no se pueda corromper el estado cada que otros lo usen."),(0,o.kt)("p",null,"Terraform nos dara un output message si se demora el proceso de locking del state file."),(0,o.kt)("p",null,"Para desabilitar el bloqueo en los comandos que usamos utilizamos el flag ",(0,o.kt)("inlineCode",{parentName:"p"},"--lock")," pero\nno es recomendado"),(0,o.kt)("p",null,"Tambien tenemos una forma de desbloquear de un state file con el comando\n",(0,o.kt)("inlineCode",{parentName:"p"},"terraform force-unlock"),". Si desbloqueamos el archivo mientras alguien lo esta utilizando\ncausamos que multiples personas modifiquen dicho archivo. Debemos usar este comando\nen las ocasiones cuando el desbloque automatico falla por cualquier razon. En estas situaciones\nterraform imprimira por consola un id el cual usaremos en el comando de la siguiente forma "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"terraform force-unlock 129239123921-ada231adsa-23123asdasd --force\n")),(0,o.kt)("p",null,"con el flag ",(0,o.kt)("inlineCode",{parentName:"p"},"--force")," skipeamos la confirmacion de lockeo."),(0,o.kt)("h3",{id:"proteger-informacion-sensible"},"Proteger informacion sensible"),(0,o.kt)("p",null,"Los archivos de estado de terraform puden contener informacion sensible como contrase\xf1as, usuarios,\nips, etc. Causando posibles ataques y robo de informacion."),(0,o.kt)("p",null,"Cuando usamos local state debemos tener las siguientes consideraciones"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"No debemos compartir dicho archivo con nadie "),(0,o.kt)("li",{parentName:"ul"},"Debemos agregar dicho archivo en el .gitignore ")),(0,o.kt)("p",null,"Cuando usamos remote state debemos tener las siguientes consideraciones"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Este archivo se guarda en memoria y no en disco"),(0,o.kt)("li",{parentName:"ul"},"Este archivo esta encrypted-at-rest"),(0,o.kt)("li",{parentName:"ul"},"Este archivo esta encrypted-at-transit")),(0,o.kt)("p",null,":::cation\nSi usamos almacenamiento de tercero debemos tener en cuenta si cumple con las politicas de seguridad\ncorrespondientes para que nuestra informacion este segura y si esta activada por default.\n:::"),(0,o.kt)("h3",{id:"ignore-files"},"Ignore files"),(0,o.kt)("p",null,"Es muy parecido a la funcionalidad del ",(0,o.kt)("inlineCode",{parentName:"p"},".gitignore")," con la diferencia que terraform\nsolo leera el archivo que esta en el root module, es decir, no sirve de nada tener varios archivos\n",(0,o.kt)("inlineCode",{parentName:"p"},".terraformignore")," en los diferentes sub-modulos porque no seran leidos."),(0,o.kt)("p",null,"Por defecto sino tenemos ningun archivo ",(0,o.kt)("inlineCode",{parentName:"p"},".terraformignore"),". terraform excluira los siguientes directorios:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},".git/")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},".terraform/"))),(0,o.kt)("h2",{id:"complex-types"},"Complex Types"),(0,o.kt)("p",null,"Un complex type es un tipo de dato que agrupa multiples datos en uno."),(0,o.kt)("p",null,"Complex types los representamos por un constructor algunos tienen\ntienen una palabra reservada."),(0,o.kt)("p",null,"Tenemos dos categorias para estos tipos de datos:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Collection types (para agrupar valores similares)",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"list, map y set"))),(0,o.kt)("li",{parentName:"ul"},"Structural types (para agrupar valores que pueden no ser similares)",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"tuple y object")))),(0,o.kt)("h3",{id:"collection-types"},"Collection types"),(0,o.kt)("p",null,"Este tipo de dato nos ayuda a agrupar multiples valores del mismo tipo\nen un solo valor."),(0,o.kt)("p",null,"Tenemos 3 tipos de collection types:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"List: es como el tipico array y podemos usar index para acceder a los elementos.\nTodos los datos dentro del list deben ser del mismo tipo")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-hcl"},'variable "planet" {\n  type = list \n  default = ["mars", "earth", "moon"]\n}\nplanet = var.planet[0]\n')),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Map es como el tipico diccionario de python o JSON object,\nusamos la key para acceder al valor")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-hcl"},'variable "plans" {\n  type = map\n  default = {\n    "PlanA" = "10 USD",\n    "PlanB" = "20 USD"\n  }\n}\nplan = var.plans["PlanA"]\n')),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Sets: una colecci\xf3n de valores \xfanicos que no tienen ning\xfan\nidentificador secundario u ordenaci\xf3n. Como todos los elementos\ndeben ser del mismo tipo, se castean con el tipo de dato\ndel primer elemento.")),(0,o.kt)("h3",{id:"structural-types"},"Structural types"),(0,o.kt)("p",null,"Este tipo de dato nos ayuda a agrupar multiples valores de diferentes tipos\nen un solo valor.\nRequieren un schema como argumento con el fin de especificar que tipo de valores\nvan en cada elemento."),(0,o.kt)("p",null,"Tenemos dos tipos de structural types"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Objects es como un JSON con multiples tipos de valores")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-hcl"},'variable "plans" {\n  type = object({\n    PlanA = string,\n    PlanB = string\n  })\n  default = {\n    "PlanA" = "10 USD",\n    "PlanB" = "20 USD"\n  }\n}\nplan = var.plans["PlanA"]\n')),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Tuples es como una lista dinamica")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-hcl"},'variable "planet" {\n  type = tuple([string, number, bool]) \n  default = ["mars", 1, false]\n}\nplanet = var.planet[0]\n')),(0,o.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"Podemos usar comas como simplemente salto de linea en los maps y objects.\nNecesitamos el schema para los structural types"))),(0,o.kt)("h2",{id:"built-in-functions"},"Built-in Functions"),(0,o.kt)("p",null,"Son funciones que vienen propias de terraform que nos permite\nrealizar transformaciones o combinar valores"),(0,o.kt)("h3",{id:"numeric"},"Numeric"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"abs(num): retorna el valor absoluto del num"),(0,o.kt)("li",{parentName:"ul"},"floor(num): redondea hacia abajo el num"),(0,o.kt)("li",{parentName:"ul"},"log(num, base): retorna el logaritmo del num en la base "),(0,o.kt)("li",{parentName:"ul"},"ceil(num): redondea hacia arriba el num"),(0,o.kt)("li",{parentName:"ul"},"min(set[]): retorna el minimo valor del set"),(0,o.kt)("li",{parentName:"ul"},"max(set[]): retorna el maximo valor del set"),(0,o.kt)("li",{parentName:"ul"},"parseint(num:string, base:int): parsea a int el string numero en la base que le digamos"),(0,o.kt)("li",{parentName:"ul"},"pow(num, exp): calcula el valor de num a la exp"),(0,o.kt)("li",{parentName:"ul"},"signum(num): representa el signo del numero (-1, 0, 1)")),(0,o.kt)("h3",{id:"string"},"String"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"chomp(string): remueve los salto de lineas en los string"),(0,o.kt)("li",{parentName:"ul"},"format(string, value): como el format de python para agregar variables al string"),(0,o.kt)("li",{parentName:"ul"},"formatlist(string, valuelist): como el anterior pero con una lista de valores"),(0,o.kt)("li",{parentName:"ul"},"indent(spaces, string): agrega la identacion "),(0,o.kt)("li",{parentName:"ul"},"join(delimiter, list(string)): une todos los elementos de un array usando el delimiter\nen un solo string"),(0,o.kt)("li",{parentName:"ul"},"lower(string): regresa todo en minusculas del string "),(0,o.kt)("li",{parentName:"ul"},"regex(regex, string): aplica una expresion regular a un string y devuelve los substrings"),(0,o.kt)("li",{parentName:"ul"},"replace(phrase, stringReplace, newString): reemplaza el stringReplace por el newString en el phrase"),(0,o.kt)("li",{parentName:"ul"},"split(delimeter, string): transforma el string en un array, usa el delimiter para saber el inicio\ny fin de cada elemento"),(0,o.kt)("li",{parentName:"ul"},"strrev(string): el reverso del string"),(0,o.kt)("li",{parentName:"ul"},"substr(string, from, to) slice de un string desde from hasta to "),(0,o.kt)("li",{parentName:"ul"},"title(string): capitaliza un string es decir convierte en mayusculas la primera letra de cada palabra"),(0,o.kt)("li",{parentName:"ul"},"trim(string, delimiter): elimina el delimiter del string al inicio y al final"),(0,o.kt)("li",{parentName:"ul"},"trimprefix(string, delimiter): elimina el delimiter del inicio"),(0,o.kt)("li",{parentName:"ul"},"trimsuffix(string, delimiter): elimina el delimiter del final"),(0,o.kt)("li",{parentName:"ul"},"trimspace(string): elimita todos los whitespaces"),(0,o.kt)("li",{parentName:"ul"},"upper(string): pone en mayuscula un string")),(0,o.kt)("h3",{id:"collection"},"Collection"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"alltrue(list) retorna true si todos los elementos son true o si es una collection vacia sino retorna false"),(0,o.kt)("li",{parentName:"ul"},"anytrue(list) retorna true si existe algun true sino retorna false"),(0,o.kt)("li",{parentName:"ul"},"chunklist(list, size) retorna una lista de lista, crea agrupaciones de elementos de un tama\xf1o establecido"),(0,o.kt)("li",{parentName:"ul"},"coalesce(list) retorna el primer valor que no es null o un string vacio"),(0,o.kt)("li",{parentName:"ul"},"coalescelist(list1, list2, list3) retorna la primera lista que no sea vacia"),(0,o.kt)("li",{parentName:"ul"},"compact(list) retorna una lista sin string vacios "),(0,o.kt)("li",{parentName:"ul"},"concat(list1, list2) retorna la fusion de dos listas en una"),(0,o.kt)("li",{parentName:"ul"},"contains(list, element) retorna true si la lista contiene el elemento caso contrario false"),(0,o.kt)("li",{parentName:"ul"},"distinct(list) retorna una lista sin los duplicados, solo con los elementos unicos"),(0,o.kt)("li",{parentName:"ul"},"element(list, index) retorna el elemento en la posicion index de la lista"),(0,o.kt)("li",{parentName:"ul"},"index(list, element) retorna el index del element de la lista"),(0,o.kt)("li",{parentName:"ul"},"flatten(list) retorna una lista sin toda la listas anidadas"),(0,o.kt)("li",{parentName:"ul"},"length(list) retorna la cantidad de elementos de la lista "),(0,o.kt)("li",{parentName:"ul"},"keys(map) retorna una lista con las claves del map"),(0,o.kt)("li",{parentName:"ul"},"lookup(map, key, default) retorna el valor de la key sino lo encuentra devuelve default"),(0,o.kt)("li",{parentName:"ul"},"matchkeys(list1, list2, list3) retorna una lista con los elementos que se repiten"),(0,o.kt)("li",{parentName:"ul"},"merge(maps) retorna un solo map con todos los maps que le pasamos por argumentos fusionados en uno solo."),(0,o.kt)("li",{parentName:"ul"},"one(list) retorna el primer elemento de una lista"),(0,o.kt)("li",{parentName:"ul"},"range(number) genera una lista de numeros consecutivos usando el number como limite"),(0,o.kt)("li",{parentName:"ul"},"reverse(list) genera una lista con el orden reverso"),(0,o.kt)("li",{parentName:"ul"},"setintersection() retorna una lista con la interseccion "),(0,o.kt)("li",{parentName:"ul"},"setproduct() retorna una lista con toda las posibles combinaciones de los elementos dentro "),(0,o.kt)("li",{parentName:"ul"},"setsubtract() retorna los elementos que no tengan en comun de varias listas"),(0,o.kt)("li",{parentName:"ul"},"setunion() retorna una lista de todos los elementos "),(0,o.kt)("li",{parentName:"ul"},"sort() retorna un array ordenado de forma lexicographically"),(0,o.kt)("li",{parentName:"ul"},"slice() slice de un array"),(0,o.kt)("li",{parentName:"ul"},"sum() retorna la suma de los elementos de una lista"),(0,o.kt)("li",{parentName:"ul"},"values(map) retorna una lista con los valores del map"),(0,o.kt)("li",{parentName:"ul"},"zipmap(keysList, valuesList) retorna un map con las claves y lo valores en sus listas respectivas")),(0,o.kt)("h3",{id:"encoding"},"Encoding"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"base64encode(string) retorna un string en base64"),(0,o.kt)("li",{parentName:"ul"},"jsonencode(string) retorna un string en json"),(0,o.kt)("li",{parentName:"ul"},"yamlencode(string) "),(0,o.kt)("li",{parentName:"ul"},"textencodebase64"),(0,o.kt)("li",{parentName:"ul"},"base64gzip()"),(0,o.kt)("li",{parentName:"ul"},"urlencode() ")),(0,o.kt)("h3",{id:"decoding"},"Decoding"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"base64decode(string) retorna un string decodeado"),(0,o.kt)("li",{parentName:"ul"},"csvdecode()"),(0,o.kt)("li",{parentName:"ul"},"jsondecode()"),(0,o.kt)("li",{parentName:"ul"},"textdecodebase64()"),(0,o.kt)("li",{parentName:"ul"},"yamldecode()")),(0,o.kt)("h3",{id:"filesystem"},"Filesystem"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"abspath(path.root) me devuelve el path absoluto de un path relativo"),(0,o.kt)("li",{parentName:"ul"},'dirname("foo/bar/baz.txt") devuelve la carpeta o el direction elimina el archivo'),(0,o.kt)("li",{parentName:"ul"},"pathexpand() devuelve el path absolut"),(0,o.kt)("li",{parentName:"ul"},"basename() devuelve el nombre del archivo dado un path"),(0,o.kt)("li",{parentName:"ul"},"file() lee el contenido de un archivo"),(0,o.kt)("li",{parentName:"ul"},"fileexists() determina si un archivo existe"),(0,o.kt)("li",{parentName:"ul"},"fileset() retorna una lista con los paths de los archivos que solicite"),(0,o.kt)("li",{parentName:"ul"},"filebase64() retorna el valor del archivo en base64 bueno para imagenes"),(0,o.kt)("li",{parentName:"ul"},"templatefile() retorna una lista con los valores del archivo de configuracion")),(0,o.kt)("h3",{id:"date-and-time"},"Date and time"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"formatdate() formateamos una fecha UTC en el formato que queramos"),(0,o.kt)("li",{parentName:"ul"},"timeadd() agregamos tiempo a una hora"),(0,o.kt)("li",{parentName:"ul"},"timestamp() retorna el tiempo en UTC")),(0,o.kt)("h3",{id:"hash-and-cripto"},"Hash and Cripto"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"base64sha256()"),(0,o.kt)("li",{parentName:"ul"},"base64sha512()"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"bcrypt()")),(0,o.kt)("li",{parentName:"ul"},"filebase64sha256()"),(0,o.kt)("li",{parentName:"ul"},"filebase64sha512()"),(0,o.kt)("li",{parentName:"ul"},"filemd5()"),(0,o.kt)("li",{parentName:"ul"},"filesha1()"),(0,o.kt)("li",{parentName:"ul"},"filesha256()"),(0,o.kt)("li",{parentName:"ul"},"filesha512()"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"md5()")),(0,o.kt)("li",{parentName:"ul"},"rsadecrypt()"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"sha1()")),(0,o.kt)("li",{parentName:"ul"},"sha256()"),(0,o.kt)("li",{parentName:"ul"},"sha512()"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"uuid()")),(0,o.kt)("li",{parentName:"ul"},"uuidv5()")),(0,o.kt)("h3",{id:"ip-network"},"Ip network"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"cidrhost()"),(0,o.kt)("li",{parentName:"ul"},"cidrnetmask()"),(0,o.kt)("li",{parentName:"ul"},"cidrsubnet()"),(0,o.kt)("li",{parentName:"ul"},"cidrsubnets()")),(0,o.kt)("h3",{id:"type-conversion"},"Type conversion"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"can() retorna true si el valor existe"),(0,o.kt)("li",{parentName:"ul"},"defaults()"),(0,o.kt)("li",{parentName:"ul"},"nonsensitive() a un valor sensible lo trata como no sensible"),(0,o.kt)("li",{parentName:"ul"},"sensitive() trata a un valor como sensible"),(0,o.kt)("li",{parentName:"ul"},"tobool() convierte un valor en boolean"),(0,o.kt)("li",{parentName:"ul"},"tomap() convierte un valor en un map"),(0,o.kt)("li",{parentName:"ul"},"toset() convierte un valor en un set"),(0,o.kt)("li",{parentName:"ul"},"tolist() convierte un valor en una lista"),(0,o.kt)("li",{parentName:"ul"},"tonumber() convierte un valor en un numero"),(0,o.kt)("li",{parentName:"ul"},"tostring() convierte un valor en un string"),(0,o.kt)("li",{parentName:"ul"},"try()")),(0,o.kt)("h2",{id:"terraform-cloud"},"Terraform cloud"),(0,o.kt)("p",null,"Terraform cloud es una plataforma que ayuda a los equipos a usar terraform\ntiene las siguientes features:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Manejo de los state files "),(0,o.kt)("li",{parentName:"ul"},"historial de ejecucion de pipelines"),(0,o.kt)("li",{parentName:"ul"},"historial de estados previos"),(0,o.kt)("li",{parentName:"ul"},"inyeccion de variables facil y seguro"),(0,o.kt)("li",{parentName:"ul"},"tageo"),(0,o.kt)("li",{parentName:"ul"},"triggers"),(0,o.kt)("li",{parentName:"ul"},"workspace"),(0,o.kt)("li",{parentName:"ul"},"compartir el estado de forma global"),(0,o.kt)("li",{parentName:"ul"},"comentar en la ejecucion del pipeline"),(0,o.kt)("li",{parentName:"ul"},"Niveles de permisos como en gcp"),(0,o.kt)("li",{parentName:"ul"},"Notificaciones via slack, email, etc."),(0,o.kt)("li",{parentName:"ul"},"Policy as code usando sentinel"),(0,o.kt)("li",{parentName:"ul"},"MFA"),(0,o.kt)("li",{parentName:"ul"},"Estimacion de costos "),(0,o.kt)("li",{parentName:"ul"},"Multiples integraciones")),(0,o.kt)("h3",{id:"terminos"},"Terminos"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Organization: es el conjunto de workspaces"),(0,o.kt)("li",{parentName:"ul"},"Workspace: es un ambiente unico "),(0,o.kt)("li",{parentName:"ul"},"Teams: se componene por multiples miembros y puede acceder a diferentes workspace"),(0,o.kt)("li",{parentName:"ul"},"Runs: ejecucion del execution plan en un ambiente virtual")),(0,o.kt)("h3",{id:"run-workflows"},"Run workflows"),(0,o.kt)("p",null,"tenemos 3 tipos:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Version control workflow se produce cuando ejecutamos un PR en github o hacemos un merge"),(0,o.kt)("li",{parentName:"ol"},"CLI-driven cuando de forma local ejecutamos comandos como terraform apply"),(0,o.kt)("li",{parentName:"ol"},"API-driven usando el api de terraform ")),(0,o.kt)("h3",{id:"organizational-level-permissions"},"Organizational Level permissions"))}d.isMDXComponent=!0},9079:function(e,a,n){a.Z=n.p+"assets/images/dependecy-graph-bec318bc110ab9d4dfc395d0bd7b8ad0.png"},4586:function(e,a,n){a.Z=n.p+"assets/images/gitops-223937080c003954cd43e8a282248adf.png"},5662:function(e,a,n){a.Z=n.p+"assets/images/module-structure-65afc3458830286f469af5740ad65788.png"},4849:function(e,a,n){a.Z=n.p+"assets/images/traditional-it-23f7c16bffb1bdbb380410a03ebca967.png"}}]);